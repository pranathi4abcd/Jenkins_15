(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{g8Cg:function(e,t,i){"use strict";i.r(t),i.d(t,"RawItemEntryModule",function(){return P});var s=i("ofXK"),l=i("tyNb"),a=i("Nach"),n=i("CwUn"),c=i("fXoL"),r=i("A1d6"),o=i("NLkC"),d=i("dcBc"),m=i("eO1q"),u=i("3Pt+"),h=i("rEr+"),b=i("7zfz"),p=i("AAHA"),I=i("jIHw"),f=i("7kUa"),S=i("arFO"),w=i("Ks7X");const y=["myForm"],g=["dt"],v=["filtr"];function C(e,t){1&e&&(c.Yb(0,"div",5),c.Yb(1,"label",6),c.Uc(2,"Center "),c.Yb(3,"span",7),c.Uc(4,"*"),c.Xb(),c.Xb(),c.Xb())}function D(e,t){if(1&e){const e=c.Zb();c.Yb(0,"div",10),c.Yb(1,"app-center-dropdown",21),c.ic("onclinicSelect",function(t){return c.Lc(e),c.mc().onclinicSelect(t)}),c.Xb(),c.Xb()}2&e&&(c.Fb(1),c.tc("isCenterLabel",!1)("mode","get"))}function R(e,t){if(1&e){const e=c.Zb();c.Yb(0,"button",22),c.ic("click",function(){return c.Lc(e),c.mc().SaveAllItems()}),c.Uc(1,"Save All"),c.Xb()}}function M(e,t){if(1&e){const e=c.Zb();c.Yb(0,"div",23),c.Yb(1,"span",24),c.Yb(2,"button",25),c.ic("click",function(){return c.Lc(e),c.mc().exportToItemExcel()}),c.Xb(),c.Yb(3,"span",26),c.Tb(4,"i",27),c.Yb(5,"input",28),c.ic("input",function(t){return c.Lc(e),c.mc(),c.Ic(17).filterGlobal(t.target.value,"contains")}),c.Xb(),c.Xb(),c.Xb(),c.Xb()}}function U(e,t){1&e&&(c.Yb(0,"tr"),c.Yb(1,"td"),c.Uc(2," No records found "),c.Xb(),c.Xb()),2&e&&(c.Fb(1),c.Gb("colspan",3))}function T(e,t){1&e&&c.Tb(0,"col",30)}function X(e,t){if(1&e&&(c.Yb(0,"colgroup"),c.Tb(1,"col",29),c.Tb(2,"col",30),c.Tb(3,"col",31),c.Sc(4,T,1,0,"col",32),c.Xb()),2&e){const e=c.mc();c.Fb(4),c.tc("ngIf",e.UserTypeCurre===e.userTypes.Cafeteria)}}function x(e,t){1&e&&(c.Yb(0,"th"),c.Uc(1,"Action"),c.Xb())}function Y(e,t){if(1&e&&(c.Yb(0,"tr"),c.Yb(1,"th"),c.Uc(2,"Item Name"),c.Xb(),c.Yb(3,"th"),c.Uc(4,"Unit"),c.Xb(),c.Yb(5,"th"),c.Uc(6,"Quantity"),c.Xb(),c.Sc(7,x,2,0,"th",33),c.Xb()),2&e){const e=c.mc();c.Fb(7),c.tc("ngIf",e.UserTypeCurre===e.userTypes.Cafeteria)}}function O(e,t){1&e&&c.Uc(0),2&e&&c.Wc(" ",t.$implicit.name," ")}function E(e,t){if(1&e){const e=c.Zb();c.Yb(0,"td"),c.Yb(1,"a",37),c.ic("click",function(){c.Lc(e);const t=c.mc().rowIndex;return c.mc().DeleteRawItem(t)}),c.Tb(2,"img",38),c.Xb(),c.Xb()}}const F=function(){return{width:"100%"}};function A(e,t){if(1&e&&(c.Yb(0,"tr"),c.Yb(1,"td"),c.Uc(2),c.Xb(),c.Yb(3,"td"),c.Yb(4,"p-dropdown",34),c.ic("ngModelChange",function(e){return t.$implicit.UOMS=e}),c.Sc(5,O,1,1,"ng-template",35),c.Xb(),c.Xb(),c.Yb(6,"td"),c.Yb(7,"p-inputNumber",36),c.ic("ngModelChange",function(e){return t.$implicit.Qty=e}),c.Xb(),c.Xb(),c.Sc(8,E,3,0,"td",33),c.Xb()),2&e){const e=t.$implicit,i=t.rowIndex,s=c.mc();c.Fb(2),c.Vc(e.ItemName),c.Fb(2),c.Pc(c.yc(16,F)),c.tc("options",s.UMList)("ngModel",e.UOMS)("filter",!0)("showClear",!0)("disabled",s.UserTypeCurre!==s.userTypes.Cafeteria),c.Fb(3),c.Pc(c.yc(17,F)),c.vc("name","Qty_",i,""),c.tc("ngModel",e.Qty)("useGrouping",!1)("maxlength",5)("disabled",s.UserTypeCurre!==s.userTypes.Cafeteria),c.Fb(1),c.tc("ngIf",s.UserTypeCurre===s.userTypes.Cafeteria)}}const _=function(){return{standalone:!0}},L=function(){return["ItemName","UOMS","Qty"]},Q=[{path:"",component:(()=>{class e extends n.a{constructor(e,t,i,s,l,n){super(),this._ClinicServices=e,this._UtilityService=t,this._MasterServices=i,this._ConstantServices=s,this.datepipe=l,this.cdRef=n,this.filteredValuesLength=0,this.userTypes=a.s,this.DisMode=null,this.customDateFormat=a.h,this.today=new Date,this.selection={},this.UserTypeCurre=localStorage.getItem("userTypeId"),this.loginId=localStorage.getItem("userId"),this.extraItemRowCounter=0,this.ClinicIdSelected="",this.TempRawItemDetailsDTO={},this.lstExtraItemDetails=[],this.selectedRawItemDetails=[],this._ConstantServices.ActiveMenuName="Raw Item Details",this.SelectDate=new Date,this.UMList=[{name:"PCS",code:"PCS"},{name:"kg",code:"kg"},{name:"gm",code:"gm"},{name:"mg",code:"mg"},{name:"ltr",code:"ltr"},{name:"ml",code:"ml"}]}ngOnInit(){a.s.SuperAdmin!==localStorage.getItem("userTypeId")&&(this.ClinicIdSelected=localStorage.getItem("ClinicId"),this.LoadConsumedRawItem())}onclinicSelect(e){this.ClinicIdSelected=e,this.LoadConsumedRawItem()}LoadConsumedRawItem(){this.selectedRawItemDetails=[],this._UtilityService.showSpinner(),this.unsubscribe.add=this._ClinicServices.GetRawItemDetailsList(this.ClinicIdSelected,this.datepipe.transform(this.SelectDate,"MM-dd-yyyy")).subscribe(e=>{if(this._UtilityService.hideSpinner(),this.cdRef.detectChanges(),1==e.actionResult.success){var t=JSON.parse(e.actionResult.result);this.selectedRawItemDetails=t=t||[],this.UserTypeCurre!==a.s.Cafeteria&&(this.selectedRawItemDetails=this.selectedRawItemDetails.filter(e=>null!=e.RawItemDetailsId)),this.cdRef.detectChanges()}else this.selectedRawItemDetails=[]})}SaveAllItems(){var e=[],t=!0;this.selectedRawItemDetails.forEach(i=>{""!=(null==i?void 0:i.UOMS)&&null!=(null==i?void 0:i.UOMS)&&0!=(null==i?void 0:i.Qty)&&null!=(null==i?void 0:i.Qty)?e.push({RawItemMasterId:i.RawItemMasterId,UOMS:i.UOMS,Qty:i.Qty}):0==(null==i?void 0:i.Qty)||null==(null==i?void 0:i.Qty)||null!=(null==i?void 0:i.UOMS)&&""!=(null==i?void 0:i.UOMS)||(t=!1)}),t?(this.TempRawItemDetailsDTO.ClinicId=this.ClinicIdSelected,this.TempRawItemDetailsDTO.ModifiedBy=this.loginId,this.TempRawItemDetailsDTO.PurchaseDate=new Date(this.datepipe.transform(this.SelectDate,"yyyy-MM-dd")),this.TempRawItemDetailsDTO.lstTempRawItemDetails=e,this._UtilityService.showSpinner(),this.unsubscribe.add=this._ClinicServices.SaveRawItemDetails(this.TempRawItemDetailsDTO).subscribe(e=>{this._UtilityService.hideSpinner(),1==e.actionResult.success?(this._UtilityService.showSuccessAlert("Add successfully"),this.LoadConsumedRawItem()):this._UtilityService.showWarningAlert("Item Details Not Save !!")},e=>{this._UtilityService.hideSpinner(),this._UtilityService.showErrorAlert(e.message)})):this._UtilityService.showWarningAlert("Please select all Item Details")}DeleteRawItem(e){this.selectedRawItemDetails[e].Qty=null,this.selectedRawItemDetails[e].UOMS=this.selectedRawItemDetails[e].DefaultUOMS,this.cdRef.detectChanges()}exportToItemExcel(){let e={reportname:"RawItemDetails",filename:"RawItemDetails"};e.ClinicId=this.ClinicIdSelected,e.dFrom=new Date(this.datepipe.transform(this.SelectDate,"yyyy-MM-dd")),this._MasterServices.downloadReport(e)}GetRawItemMasterList(){this.itemMaster=[],null!=this.ClinicIdSelected||null!=this.ClinicIdSelected?(this._UtilityService.showSpinner(),this.unsubscribe.add=this._MasterServices.GetRawItemMasterList(this.ClinicIdSelected,!0).subscribe(e=>{var t;if(this._UtilityService.hideSpinner(),this.cdRef.detectChanges(),1==e.actionResult.success){var i=JSON.parse(e.actionResult.result);this.itemMaster=i=i||[],void 0!==this.filtr&&(this.filtr.nativeElement.value="",this.dataTable.reset(),this.filteredValuesLength=null===(t=this.itemMaster)||void 0===t?void 0:t.length),this.cdRef.detectChanges()}else this.itemMaster=[]})):this._UtilityService.showWarningAlert("Please select center")}nodeSelect(e,t){this.lstExtraItemDetails[t].RawItemMasterId=e.value.RawItemMasterId,this.lstExtraItemDetails[t].ItemName=e.originalEvent.currentTarget.ariaLabel,this.cdRef.detectChanges(),$("#btnCloseOverlayItem").click()}AddExtraItemDetails(){this.extraItemRowCounter=this.lstExtraItemDetails.length+1,this.lstExtraItemDetails.push({Sequence:this.extraItemRowCounter,RawItemMasterId:"",ItemName:"",Qty:1,UOMS:""})}AddRawItem(){var e=[],t=!0;if(null!=this.ClinicIdSelected&&null!=this.ClinicIdSelected&&""!=this.ClinicIdSelected)if(this.lstExtraItemDetails.forEach(i=>{if(""!=i.RawItemMasterId&&null!=i.RawItemMasterId&&""!=i.UOMS&&null!=i.UOMS&&0!=Number(i.Qty)){var s={RawItemMasterId:i.RawItemMasterId,ItemName:i.ItemName,UOMS:i.UOMS,Qty:Number(i.Qty)};e.push(s)}else t=!1}),0!=e.length)if(t){for(let t=0;t<e.length;t++){var i=this.selectedRawItemDetails.filter(i=>i.RawItemMasterId==e[t].RawItemMasterId);null!=i&&null!=i&&(this.selectedRawItemDetails=this.selectedRawItemDetails.filter(i=>i.RawItemMasterId!==e[t].RawItemMasterId)),this.selectedRawItemDetails.push(e[t])}this.extraItemRowCounter=0,this.lstExtraItemDetails=[],this.AddExtraItemDetails()}else this._UtilityService.showWarningAlert("Please select all Item Details");else this._UtilityService.showWarningAlert("please select atleast 1 Item");else this._UtilityService.showWarningAlert("Please select center")}RemoveExtraItemDetails(e){1!=e&&(this.lstExtraItemDetails=this.lstExtraItemDetails.filter(t=>t.Sequence!==e))}ResetItem(e){this.lstExtraItemDetails[e-1].RawItemMasterId="",this.lstExtraItemDetails[e-1].ItemName="",this.lstExtraItemDetails[e-1].Qty=1,this.lstExtraItemDetails[e-1].UOMS="",this.cdRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(c.Sb(r.a),c.Sb(o.a),c.Sb(d.a),c.Sb(a.f),c.Sb(s.f),c.Sb(c.h))},e.\u0275cmp=c.Mb({type:e,selectors:[["app-raw-item-entry"]],viewQuery:function(e,t){if(1&e&&(c.cd(y,1),c.cd(g,1),c.cd(v,1)),2&e){let e;c.Hc(e=c.jc())&&(t.myForm=e.first),c.Hc(e=c.jc())&&(t.dataTable=e.first),c.Hc(e=c.jc())&&(t.filtr=e.first)}},features:[c.Cb],decls:23,vars:15,consts:[[1,"card","mt25"],[1,"card-body"],[1,"row"],["class","col-auto",4,"ngIf"],["class","col col-md-3",4,"ngIf"],[1,"col-auto"],["for","",1,"pt-2"],[1,"required"],[1,"col","col-md-auto"],["inputId","icon",3,"maxDate","ngModel","ngModelOptions","showIcon","dateFormat","readonlyInput","ngModelChange","onClose"],[1,"col","col-md-3"],["type","button","class","btn btn-new-primary",3,"click",4,"ngIf"],[1,"row","mt-3"],[1,"col","col-md-12"],["responsiveLayout","scroll","styleClass","p-datatable-striped","scrollHeight","calc(100vh - 240px)",3,"value","rowHover","globalFilterFields","scrollable"],["dt1",""],["pTemplate","caption"],["pTemplate","emptymessage"],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],[3,"isCenterLabel","mode","onclinicSelect"],["type","button",1,"btn","btn-new-primary",3,"click"],[1,"p-d-flex"],[1,"p-ml-auto"],["pButton","","title","Export Data","label"," ","icon","pi pi-download",1,"p-button-outlined","mr-2",3,"click"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[2,"width","180px"],[2,"width","60px"],[2,"width","100px"],["style","width:60px",4,"ngIf"],[4,"ngIf"],["appendTo","body","optionLabel","name","optionValue","name","placeholder","Select Unit",3,"options","ngModel","filter","showClear","disabled","ngModelChange"],["pTemplate","item"],[3,"name","ngModel","useGrouping","maxlength","disabled","ngModelChange"],["matTooltip","Delete",3,"click"],["src","./assets/custom-icons/no.svg",1,"custom-ico"]],template:function(e,t){1&e&&(c.Yb(0,"div",0),c.Yb(1,"div",1),c.Yb(2,"div",2),c.Sc(3,C,5,0,"div",3),c.Sc(4,D,2,2,"div",4),c.Yb(5,"div",5),c.Yb(6,"label",6),c.Uc(7,"Date: "),c.Yb(8,"span",7),c.Uc(9,"*"),c.Xb(),c.Xb(),c.Xb(),c.Yb(10,"div",8),c.Yb(11,"p-calendar",9),c.ic("ngModelChange",function(e){return t.SelectDate=e})("onClose",function(){return t.LoadConsumedRawItem()}),c.Xb(),c.Xb(),c.Yb(12,"div",10),c.Sc(13,R,2,0,"button",11),c.Xb(),c.Xb(),c.Yb(14,"div",12),c.Yb(15,"div",13),c.Yb(16,"p-table",14,15),c.Sc(18,M,6,0,"ng-template",16),c.Sc(19,U,3,1,"ng-template",17),c.Sc(20,X,5,1,"ng-template",18),c.Sc(21,Y,8,1,"ng-template",19),c.Sc(22,A,9,18,"ng-template",20),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Xb()),2&e&&(c.Fb(3),c.tc("ngIf",t.UserTypeCurre===t.userTypes.SuperAdmin),c.Fb(1),c.tc("ngIf",t.UserTypeCurre===t.userTypes.SuperAdmin),c.Fb(7),c.tc("maxDate",t.today)("ngModel",t.SelectDate)("ngModelOptions",c.yc(13,_))("showIcon",!0)("dateFormat",t.customDateFormat.CalendarFormat)("readonlyInput",!1),c.Fb(2),c.tc("ngIf",t.UserTypeCurre===t.userTypes.Cafeteria),c.Fb(3),c.tc("value",t.selectedRawItemDetails)("rowHover",!0)("globalFilterFields",c.yc(14,L))("scrollable",!0))},directives:[s.p,m.a,u.o,u.r,h.c,b.i,p.a,I.b,f.a,S.a,w.a,u.j],styles:[""]}),e})()}];let N=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.Qb({type:e}),e.\u0275inj=c.Pb({imports:[[l.l.forChild(Q)],l.l]}),e})();var k=i("T2Aj");let P=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.Qb({type:e}),e.\u0275inj=c.Pb({imports:[[s.c,N,u.i,h.f,I.c,S.b,f.b,m.b,w.b,k.a]]}),e})()}}]);