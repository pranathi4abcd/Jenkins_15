!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function n(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var i,n=l(e);if(t){var r=l(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return a(this,i)}}function a(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{g8Cg:function(a,l,r){"use strict";r.r(l),r.d(l,"RawItemEntryModule",function(){return J});var c=r("ofXK"),s=r("tyNb"),o=r("Nach"),u=r("CwUn"),d=r("fXoL"),m=r("A1d6"),b=r("NLkC"),p=r("dcBc"),f=r("eO1q"),h=r("3Pt+"),I=r("rEr+"),y=r("7zfz"),v=r("AAHA"),w=r("jIHw"),S=r("7kUa"),g=r("arFO"),R=r("Ks7X"),C=["myForm"],D=["dt"],M=["filtr"];function U(e,t){1&e&&(d.Yb(0,"div",5),d.Yb(1,"label",6),d.Uc(2,"Center "),d.Yb(3,"span",7),d.Uc(4,"*"),d.Xb(),d.Xb(),d.Xb())}function T(e,t){if(1&e){var i=d.Zb();d.Yb(0,"div",10),d.Yb(1,"app-center-dropdown",21),d.ic("onclinicSelect",function(e){return d.Lc(i),d.mc().onclinicSelect(e)}),d.Xb(),d.Xb()}2&e&&(d.Fb(1),d.tc("isCenterLabel",!1)("mode","get"))}function O(e,t){if(1&e){var i=d.Zb();d.Yb(0,"button",22),d.ic("click",function(){return d.Lc(i),d.mc().SaveAllItems()}),d.Uc(1,"Save All"),d.Xb()}}function X(e,t){if(1&e){var i=d.Zb();d.Yb(0,"div",23),d.Yb(1,"span",24),d.Yb(2,"button",25),d.ic("click",function(){return d.Lc(i),d.mc().exportToItemExcel()}),d.Xb(),d.Yb(3,"span",26),d.Tb(4,"i",27),d.Yb(5,"input",28),d.ic("input",function(e){return d.Lc(i),d.mc(),d.Ic(17).filterGlobal(e.target.value,"contains")}),d.Xb(),d.Xb(),d.Xb(),d.Xb()}}function x(e,t){1&e&&(d.Yb(0,"tr"),d.Yb(1,"td"),d.Uc(2," No records found "),d.Xb(),d.Xb()),2&e&&(d.Fb(1),d.Gb("colspan",3))}function Y(e,t){1&e&&d.Tb(0,"col",30)}function _(e,t){if(1&e&&(d.Yb(0,"colgroup"),d.Tb(1,"col",29),d.Tb(2,"col",30),d.Tb(3,"col",31),d.Sc(4,Y,1,0,"col",32),d.Xb()),2&e){var i=d.mc();d.Fb(4),d.tc("ngIf",i.UserTypeCurre===i.userTypes.Cafeteria)}}function E(e,t){1&e&&(d.Yb(0,"th"),d.Uc(1,"Action"),d.Xb())}function k(e,t){if(1&e&&(d.Yb(0,"tr"),d.Yb(1,"th"),d.Uc(2,"Item Name"),d.Xb(),d.Yb(3,"th"),d.Uc(4,"Unit"),d.Xb(),d.Yb(5,"th"),d.Uc(6,"Quantity"),d.Xb(),d.Sc(7,E,2,0,"th",33),d.Xb()),2&e){var i=d.mc();d.Fb(7),d.tc("ngIf",i.UserTypeCurre===i.userTypes.Cafeteria)}}function F(e,t){1&e&&d.Uc(0),2&e&&d.Wc(" ",t.$implicit.name," ")}function A(e,t){if(1&e){var i=d.Zb();d.Yb(0,"td"),d.Yb(1,"a",37),d.ic("click",function(){d.Lc(i);var e=d.mc().rowIndex;return d.mc().DeleteRawItem(e)}),d.Tb(2,"img",38),d.Xb(),d.Xb()}}var L=function(){return{width:"100%"}};function Q(e,t){if(1&e&&(d.Yb(0,"tr"),d.Yb(1,"td"),d.Uc(2),d.Xb(),d.Yb(3,"td"),d.Yb(4,"p-dropdown",34),d.ic("ngModelChange",function(e){return t.$implicit.UOMS=e}),d.Sc(5,F,1,1,"ng-template",35),d.Xb(),d.Xb(),d.Yb(6,"td"),d.Yb(7,"p-inputNumber",36),d.ic("ngModelChange",function(e){return t.$implicit.Qty=e}),d.Xb(),d.Xb(),d.Sc(8,A,3,0,"td",33),d.Xb()),2&e){var i=t.$implicit,n=t.rowIndex,a=d.mc();d.Fb(2),d.Vc(i.ItemName),d.Fb(2),d.Pc(d.yc(16,L)),d.tc("options",a.UMList)("ngModel",i.UOMS)("filter",!0)("showClear",!0)("disabled",a.UserTypeCurre!==a.userTypes.Cafeteria),d.Fb(3),d.Pc(d.yc(17,L)),d.vc("name","Qty_",n,""),d.tc("ngModel",i.Qty)("useGrouping",!1)("maxlength",5)("disabled",a.UserTypeCurre!==a.userTypes.Cafeteria),d.Fb(1),d.tc("ngIf",a.UserTypeCurre===a.userTypes.Cafeteria)}}var N,P,j,H=function(){return{standalone:!0}},G=function(){return["ItemName","UOMS","Qty"]},W=[{path:"",component:(N=function(a){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(u,a);var l,r,c,s=n(u);function u(t,i,n,a,l,r){var c;return e(this,u),(c=s.call(this))._ClinicServices=t,c._UtilityService=i,c._MasterServices=n,c._ConstantServices=a,c.datepipe=l,c.cdRef=r,c.filteredValuesLength=0,c.userTypes=o.s,c.DisMode=null,c.customDateFormat=o.h,c.today=new Date,c.selection={},c.UserTypeCurre=localStorage.getItem("userTypeId"),c.loginId=localStorage.getItem("userId"),c.extraItemRowCounter=0,c.ClinicIdSelected="",c.TempRawItemDetailsDTO={},c.lstExtraItemDetails=[],c.selectedRawItemDetails=[],c._ConstantServices.ActiveMenuName="Raw Item Details",c.SelectDate=new Date,c.UMList=[{name:"PCS",code:"PCS"},{name:"kg",code:"kg"},{name:"gm",code:"gm"},{name:"mg",code:"mg"},{name:"ltr",code:"ltr"},{name:"ml",code:"ml"}],c}return l=u,(r=[{key:"ngOnInit",value:function(){o.s.SuperAdmin!==localStorage.getItem("userTypeId")&&(this.ClinicIdSelected=localStorage.getItem("ClinicId"),this.LoadConsumedRawItem())}},{key:"onclinicSelect",value:function(e){this.ClinicIdSelected=e,this.LoadConsumedRawItem()}},{key:"LoadConsumedRawItem",value:function(){var e=this;this.selectedRawItemDetails=[],this._UtilityService.showSpinner(),this.unsubscribe.add=this._ClinicServices.GetRawItemDetailsList(this.ClinicIdSelected,this.datepipe.transform(this.SelectDate,"MM-dd-yyyy")).subscribe(function(t){if(e._UtilityService.hideSpinner(),e.cdRef.detectChanges(),1==t.actionResult.success){var i=JSON.parse(t.actionResult.result);e.selectedRawItemDetails=i=i||[],e.UserTypeCurre!==o.s.Cafeteria&&(e.selectedRawItemDetails=e.selectedRawItemDetails.filter(function(e){return null!=e.RawItemDetailsId})),e.cdRef.detectChanges()}else e.selectedRawItemDetails=[]})}},{key:"SaveAllItems",value:function(){var e=this,t=[],i=!0;this.selectedRawItemDetails.forEach(function(e){""!=(null==e?void 0:e.UOMS)&&null!=(null==e?void 0:e.UOMS)&&0!=(null==e?void 0:e.Qty)&&null!=(null==e?void 0:e.Qty)?t.push({RawItemMasterId:e.RawItemMasterId,UOMS:e.UOMS,Qty:e.Qty}):0==(null==e?void 0:e.Qty)||null==(null==e?void 0:e.Qty)||null!=(null==e?void 0:e.UOMS)&&""!=(null==e?void 0:e.UOMS)||(i=!1)}),i?(this.TempRawItemDetailsDTO.ClinicId=this.ClinicIdSelected,this.TempRawItemDetailsDTO.ModifiedBy=this.loginId,this.TempRawItemDetailsDTO.PurchaseDate=new Date(this.datepipe.transform(this.SelectDate,"yyyy-MM-dd")),this.TempRawItemDetailsDTO.lstTempRawItemDetails=t,this._UtilityService.showSpinner(),this.unsubscribe.add=this._ClinicServices.SaveRawItemDetails(this.TempRawItemDetailsDTO).subscribe(function(t){e._UtilityService.hideSpinner(),1==t.actionResult.success?(e._UtilityService.showSuccessAlert("Add successfully"),e.LoadConsumedRawItem()):e._UtilityService.showWarningAlert("Item Details Not Save !!")},function(t){e._UtilityService.hideSpinner(),e._UtilityService.showErrorAlert(t.message)})):this._UtilityService.showWarningAlert("Please select all Item Details")}},{key:"DeleteRawItem",value:function(e){this.selectedRawItemDetails[e].Qty=null,this.selectedRawItemDetails[e].UOMS=this.selectedRawItemDetails[e].DefaultUOMS,this.cdRef.detectChanges()}},{key:"exportToItemExcel",value:function(){var e={reportname:"RawItemDetails",filename:"RawItemDetails"};e.ClinicId=this.ClinicIdSelected,e.dFrom=new Date(this.datepipe.transform(this.SelectDate,"yyyy-MM-dd")),this._MasterServices.downloadReport(e)}},{key:"GetRawItemMasterList",value:function(){var e=this;this.itemMaster=[],null!=this.ClinicIdSelected||null!=this.ClinicIdSelected?(this._UtilityService.showSpinner(),this.unsubscribe.add=this._MasterServices.GetRawItemMasterList(this.ClinicIdSelected,!0).subscribe(function(t){var i;if(e._UtilityService.hideSpinner(),e.cdRef.detectChanges(),1==t.actionResult.success){var n=JSON.parse(t.actionResult.result);e.itemMaster=n=n||[],void 0!==e.filtr&&(e.filtr.nativeElement.value="",e.dataTable.reset(),e.filteredValuesLength=null===(i=e.itemMaster)||void 0===i?void 0:i.length),e.cdRef.detectChanges()}else e.itemMaster=[]})):this._UtilityService.showWarningAlert("Please select center")}},{key:"nodeSelect",value:function(e,t){this.lstExtraItemDetails[t].RawItemMasterId=e.value.RawItemMasterId,this.lstExtraItemDetails[t].ItemName=e.originalEvent.currentTarget.ariaLabel,this.cdRef.detectChanges(),$("#btnCloseOverlayItem").click()}},{key:"AddExtraItemDetails",value:function(){this.extraItemRowCounter=this.lstExtraItemDetails.length+1,this.lstExtraItemDetails.push({Sequence:this.extraItemRowCounter,RawItemMasterId:"",ItemName:"",Qty:1,UOMS:""})}},{key:"AddRawItem",value:function(){var e=this,t=[],i=!0;if(null!=this.ClinicIdSelected&&null!=this.ClinicIdSelected&&""!=this.ClinicIdSelected)if(this.lstExtraItemDetails.forEach(function(e){if(""!=e.RawItemMasterId&&null!=e.RawItemMasterId&&""!=e.UOMS&&null!=e.UOMS&&0!=Number(e.Qty)){var n={RawItemMasterId:e.RawItemMasterId,ItemName:e.ItemName,UOMS:e.UOMS,Qty:Number(e.Qty)};t.push(n)}else i=!1}),0!=t.length)if(i){for(var n=function(i){null!=(l=e.selectedRawItemDetails.filter(function(e){return e.RawItemMasterId==t[i].RawItemMasterId}))&&null!=l&&(e.selectedRawItemDetails=e.selectedRawItemDetails.filter(function(e){return e.RawItemMasterId!==t[i].RawItemMasterId})),e.selectedRawItemDetails.push(t[i])},a=0;a<t.length;a++){var l;n(a)}this.extraItemRowCounter=0,this.lstExtraItemDetails=[],this.AddExtraItemDetails()}else this._UtilityService.showWarningAlert("Please select all Item Details");else this._UtilityService.showWarningAlert("please select atleast 1 Item");else this._UtilityService.showWarningAlert("Please select center")}},{key:"RemoveExtraItemDetails",value:function(e){1!=e&&(this.lstExtraItemDetails=this.lstExtraItemDetails.filter(function(t){return t.Sequence!==e}))}},{key:"ResetItem",value:function(e){this.lstExtraItemDetails[e-1].RawItemMasterId="",this.lstExtraItemDetails[e-1].ItemName="",this.lstExtraItemDetails[e-1].Qty=1,this.lstExtraItemDetails[e-1].UOMS="",this.cdRef.detectChanges()}}])&&t(l.prototype,r),c&&t(l,c),u}(u.a),N.\u0275fac=function(e){return new(e||N)(d.Sb(m.a),d.Sb(b.a),d.Sb(p.a),d.Sb(o.f),d.Sb(c.f),d.Sb(d.h))},N.\u0275cmp=d.Mb({type:N,selectors:[["app-raw-item-entry"]],viewQuery:function(e,t){var i;1&e&&(d.cd(C,1),d.cd(D,1),d.cd(M,1)),2&e&&(d.Hc(i=d.jc())&&(t.myForm=i.first),d.Hc(i=d.jc())&&(t.dataTable=i.first),d.Hc(i=d.jc())&&(t.filtr=i.first))},features:[d.Cb],decls:23,vars:15,consts:[[1,"card","mt25"],[1,"card-body"],[1,"row"],["class","col-auto",4,"ngIf"],["class","col col-md-3",4,"ngIf"],[1,"col-auto"],["for","",1,"pt-2"],[1,"required"],[1,"col","col-md-auto"],["inputId","icon",3,"maxDate","ngModel","ngModelOptions","showIcon","dateFormat","readonlyInput","ngModelChange","onClose"],[1,"col","col-md-3"],["type","button","class","btn btn-new-primary",3,"click",4,"ngIf"],[1,"row","mt-3"],[1,"col","col-md-12"],["responsiveLayout","scroll","styleClass","p-datatable-striped","scrollHeight","calc(100vh - 240px)",3,"value","rowHover","globalFilterFields","scrollable"],["dt1",""],["pTemplate","caption"],["pTemplate","emptymessage"],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],[3,"isCenterLabel","mode","onclinicSelect"],["type","button",1,"btn","btn-new-primary",3,"click"],[1,"p-d-flex"],[1,"p-ml-auto"],["pButton","","title","Export Data","label"," ","icon","pi pi-download",1,"p-button-outlined","mr-2",3,"click"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[2,"width","180px"],[2,"width","60px"],[2,"width","100px"],["style","width:60px",4,"ngIf"],[4,"ngIf"],["appendTo","body","optionLabel","name","optionValue","name","placeholder","Select Unit",3,"options","ngModel","filter","showClear","disabled","ngModelChange"],["pTemplate","item"],[3,"name","ngModel","useGrouping","maxlength","disabled","ngModelChange"],["matTooltip","Delete",3,"click"],["src","./assets/custom-icons/no.svg",1,"custom-ico"]],template:function(e,t){1&e&&(d.Yb(0,"div",0),d.Yb(1,"div",1),d.Yb(2,"div",2),d.Sc(3,U,5,0,"div",3),d.Sc(4,T,2,2,"div",4),d.Yb(5,"div",5),d.Yb(6,"label",6),d.Uc(7,"Date: "),d.Yb(8,"span",7),d.Uc(9,"*"),d.Xb(),d.Xb(),d.Xb(),d.Yb(10,"div",8),d.Yb(11,"p-calendar",9),d.ic("ngModelChange",function(e){return t.SelectDate=e})("onClose",function(){return t.LoadConsumedRawItem()}),d.Xb(),d.Xb(),d.Yb(12,"div",10),d.Sc(13,O,2,0,"button",11),d.Xb(),d.Xb(),d.Yb(14,"div",12),d.Yb(15,"div",13),d.Yb(16,"p-table",14,15),d.Sc(18,X,6,0,"ng-template",16),d.Sc(19,x,3,1,"ng-template",17),d.Sc(20,_,5,1,"ng-template",18),d.Sc(21,k,8,1,"ng-template",19),d.Sc(22,Q,9,18,"ng-template",20),d.Xb(),d.Xb(),d.Xb(),d.Xb(),d.Xb()),2&e&&(d.Fb(3),d.tc("ngIf",t.UserTypeCurre===t.userTypes.SuperAdmin),d.Fb(1),d.tc("ngIf",t.UserTypeCurre===t.userTypes.SuperAdmin),d.Fb(7),d.tc("maxDate",t.today)("ngModel",t.SelectDate)("ngModelOptions",d.yc(13,H))("showIcon",!0)("dateFormat",t.customDateFormat.CalendarFormat)("readonlyInput",!1),d.Fb(2),d.tc("ngIf",t.UserTypeCurre===t.userTypes.Cafeteria),d.Fb(3),d.tc("value",t.selectedRawItemDetails)("rowHover",!0)("globalFilterFields",d.yc(14,G))("scrollable",!0))},directives:[c.p,f.a,h.o,h.r,I.c,y.i,v.a,w.b,S.a,g.a,R.a,h.j],styles:[""]}),N)}],B=((P=function t(){e(this,t)}).\u0275fac=function(e){return new(e||P)},P.\u0275mod=d.Qb({type:P}),P.\u0275inj=d.Pb({imports:[[s.l.forChild(W)],s.l]}),P),q=r("T2Aj"),J=((j=function t(){e(this,t)}).\u0275fac=function(e){return new(e||j)},j.\u0275mod=d.Qb({type:j}),j.\u0275inj=d.Pb({imports:[[c.c,B,h.i,I.f,w.c,g.b,S.b,f.b,R.b,q.a]]}),j)}}])}();