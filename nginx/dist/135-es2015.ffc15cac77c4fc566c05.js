(window.webpackJsonp=window.webpackJsonp||[]).push([[135],{utv7:function(t,e,n){"use strict";n.r(e),n.d(e,"TaxInvoiceReportModule",function(){return q});var o=n("ofXK"),c=n("tyNb"),i=n("CwUn"),a=n("Nach"),s=n("fXoL"),r=n("dcBc"),l=n("PtJb"),b=n("NLkC"),u=n("3Pt+"),d=n("rEr+"),p=n("7zfz"),h=n("/RsI"),m=n("AAHA"),T=n("arFO"),g=n("eO1q"),f=n("7kUa"),y=n("jIHw"),I=n("btFH");const v=["calendar"],Y=["dt"],R=["filtr"];function X(t,e){if(1&t){const t=s.Zb();s.Yb(0,"div",27),s.Yb(1,"app-center-dropdown",28),s.ic("onselectedClinic",function(e){return s.Lc(t),s.mc().onselectedClinic(e)}),s.Xb(),s.Xb()}2&t&&(s.Fb(1),s.tc("mode","get"))}const U=function(){return{width:"100%"}},A=function(){return{standalone:!0}};function D(t,e){if(1&t){const t=s.Zb();s.Yb(0,"p-dropdown",32),s.ic("ngModelChange",function(e){return s.Lc(t),s.mc(2).bookingtype=e})("onChange",function(){return s.Lc(t),s.mc(2).OnChangeBookingType()}),s.Xb()}if(2&t){const t=s.mc(2);s.Pc(s.yc(5,U)),s.tc("options",t.stlstbookingtype)("ngModel",t.bookingtype)("ngModelOptions",s.yc(6,A))}}function F(t,e){if(1&t&&(s.Yb(0,"div",7),s.Yb(1,"div",29),s.Yb(2,"label",9),s.Uc(3,"Booking Type "),s.Yb(4,"span",30),s.Uc(5,"*"),s.Xb(),s.Xb(),s.Sc(6,D,1,7,"p-dropdown",31),s.Xb(),s.Xb()),2&t){const t=s.mc();s.Fb(6),s.tc("ngIf","BOTH"==(null==t.clinicType?null:t.clinicType.toUpperCase()))}}function S(t,e){if(1&t){const t=s.Zb();s.Yb(0,"div",7),s.Yb(1,"label",9),s.Uc(2,"Customer Type"),s.Xb(),s.Yb(3,"select",33),s.ic("ngModelChange",function(e){return s.Lc(t),s.mc().CustomerType=e})("change",function(){return s.Lc(t),s.mc().LoadTaxInvoiceReportList()}),s.Yb(4,"option",34),s.Uc(5,"All"),s.Xb(),s.Yb(6,"option",35),s.Uc(7,"Patient"),s.Xb(),s.Yb(8,"option",36),s.Uc(9,"Visitor"),s.Xb(),s.Xb(),s.Xb()}if(2&t){const t=s.mc();s.Fb(3),s.tc("ngModel",t.CustomerType)}}function x(t,e){if(1&t){const t=s.Zb();s.Yb(0,"div",27),s.Yb(1,"div",8),s.Yb(2,"label",9),s.Uc(3,"From / To"),s.Yb(4,"span",30),s.Uc(5,"*"),s.Xb(),s.Xb(),s.Yb(6,"div"),s.Yb(7,"p-calendar",37,38),s.ic("ngModelChange",function(e){return s.Lc(t),s.mc().rangeDates=e})("onSelect",function(){return s.Lc(t),s.mc().dateRangeChange()}),s.Xb(),s.Xb(),s.Xb(),s.Xb()}if(2&t){const t=s.mc();s.Fb(7),s.wc("yearRange","",t.customDateFormat.MinYear,":",t.MaxYear,""),s.tc("monthNavigator",!0)("yearNavigator",!0)("ngModel",t.rangeDates)("ngModelOptions",s.yc(9,A))("showIcon",!0)("dateFormat",t.customDateFormat.CalendarFormat)("readonlyInput",!0)}}function M(t,e){if(1&t){const t=s.Zb();s.Yb(0,"div",27),s.Yb(1,"label",39),s.Yb(2,"span"),s.Uc(3,"Transaction Date"),s.Xb(),s.Xb(),s.Yb(4,"div"),s.Yb(5,"p-calendar",40),s.ic("ngModelChange",function(e){return s.Lc(t),s.mc().TranDate=e}),s.Xb(),s.Xb(),s.Xb()}if(2&t){const t=s.mc();s.Fb(5),s.wc("yearRange","",t.customDateFormat.MinYear,":",t.MaxYear,""),s.tc("maxDate",t.today)("monthNavigator",!0)("yearNavigator",!0)("ngModel",t.TranDate)("ngModelOptions",s.yc(10,A))("showIcon",!0)("dateFormat",t.customDateFormat.CalendarFormat)("readonlyInput",!0)}}function C(t,e){if(1&t){const t=s.Zb();s.Yb(0,"button",49),s.ic("click",function(){return s.Lc(t),s.mc(2).exportToItemExcel()}),s.Xb()}}function V(t,e){if(1&t){const t=s.Zb();s.Yb(0,"div",41),s.Yb(1,"span",42),s.Uc(2),s.Xb(),s.Yb(3,"span",43),s.Sc(4,C,1,0,"button",44),s.Yb(5,"span",45),s.Tb(6,"i",46),s.Yb(7,"input",47,48),s.ic("input",function(e){return s.Lc(t),s.mc(),s.Ic(28).filterGlobal(e.target.value,"contains")}),s.Xb(),s.Xb(),s.Xb(),s.Xb()}if(2&t){const t=s.mc();s.Fb(2),s.Wc(" ",(null==t.lstTaxInvoiceReport?null:t.lstTaxInvoiceReport.length)>0?"Total Records: "+t.filteredValuesLength:""," "),s.Fb(2),s.tc("ngIf",(null==t.lstIAccessStr?null:t.lstIAccessStr.includes(t.ActionList.Download.toString()))&&((null==t.lstTaxInvoiceReport?null:t.lstTaxInvoiceReport.length)>0||"RV"==t.ReportType))}}function w(t,e){1&t&&(s.Yb(0,"tr"),s.Yb(1,"td"),s.Uc(2," No records found "),s.Xb(),s.Xb()),2&t&&(s.Fb(1),s.Gb("colspan",19))}function N(t,e){1&t&&s.Tb(0,"col",55)}function L(t,e){if(1&t&&(s.Yb(0,"colgroup"),s.Sc(1,N,1,0,"col",50),s.Tb(2,"col",51),s.Tb(3,"col",51),s.Tb(4,"col",52),s.Tb(5,"col",52),s.Tb(6,"col",52),s.Tb(7,"col",53),s.Tb(8,"col",53),s.Tb(9,"col",54),s.Tb(10,"col",55),s.Tb(11,"col",54),s.Tb(12,"col",54),s.Tb(13,"col",54),s.Tb(14,"col",54),s.Tb(15,"col",54),s.Tb(16,"col",54),s.Tb(17,"col",54),s.Tb(18,"col",54),s.Tb(19,"col",54),s.Tb(20,"col",56),s.Tb(21,"col",56),s.Tb(22,"col",56),s.Tb(23,"col",56),s.Tb(24,"col",56),s.Tb(25,"col",54),s.Tb(26,"col",54),s.Tb(27,"col",54),s.Tb(28,"col",54),s.Tb(29,"col",54),s.Tb(30,"col",54),s.Xb()),2&t){const t=s.mc();s.Fb(1),s.tc("ngIf","OPD"!=t.bookingtype)}}function k(t,e){1&t&&(s.Yb(0,"th"),s.Uc(1,"Group Number"),s.Xb())}function O(t,e){if(1&t&&(s.Yb(0,"tr"),s.Sc(1,k,2,0,"th",26),s.Yb(2,"th"),s.Uc(3,"Booking Number"),s.Xb(),s.Yb(4,"th"),s.Uc(5,"Name"),s.Xb(),s.Yb(6,"th"),s.Uc(7,"MR No"),s.Xb(),s.Yb(8,"th"),s.Uc(9,"Contact"),s.Xb(),s.Yb(10,"th"),s.Uc(11,"State"),s.Xb(),s.Yb(12,"th"),s.Uc(13,"Adm. Date"),s.Xb(),s.Yb(14,"th"),s.Uc(15,"Dis. Date"),s.Xb(),s.Yb(16,"th"),s.Uc(17,"No. of Days"),s.Xb(),s.Yb(18,"th"),s.Uc(19,"Status"),s.Xb(),s.Yb(20,"th"),s.Uc(21,"Room Rent"),s.Xb(),s.Yb(22,"th"),s.Uc(23,"Treatment / Other Charges"),s.Xb(),s.Yb(24,"th"),s.Uc(25,"Total"),s.Xb(),s.Yb(26,"th"),s.Uc(27,"Discount Amount"),s.Xb(),s.Yb(28,"th"),s.Uc(29,"Discount (%)"),s.Xb(),s.Yb(30,"th"),s.Uc(31,"Room Rent Discount"),s.Xb(),s.Yb(32,"th"),s.Uc(33,"Other Charges Discount"),s.Xb(),s.Yb(34,"th"),s.Uc(35,"Transaction Amount"),s.Xb(),s.Yb(36,"th"),s.Uc(37,"Amount Payable/Refundable"),s.Xb(),s.Yb(38,"th"),s.Uc(39,"Refunded Amount"),s.Xb(),s.Yb(40,"th"),s.Uc(41,"Balance Transaction Amount"),s.Xb(),s.Yb(42,"th"),s.Uc(43,"Final Tax Inv Number"),s.Xb(),s.Yb(44,"th"),s.Uc(45,"Tax Inv Amount"),s.Xb(),s.Yb(46,"th"),s.Uc(47,"Invoice Date"),s.Xb(),s.Yb(48,"th"),s.Uc(49,"Remarks"),s.Xb(),s.Yb(50,"th"),s.Uc(51,"Requested By"),s.Xb(),s.Yb(52,"th"),s.Uc(53,"Authorized By"),s.Xb(),s.Yb(54,"th"),s.Uc(55,"Department"),s.Xb(),s.Yb(56,"th"),s.Uc(57,"Is Staff"),s.Xb(),s.Yb(58,"th"),s.Uc(59,"Action"),s.Xb(),s.Xb()),2&t){const t=s.mc();s.Fb(1),s.tc("ngIf","OPD"!=t.bookingtype)}}function B(t,e){if(1&t&&(s.Yb(0,"td"),s.Uc(1),s.Xb()),2&t){const t=s.mc().$implicit;s.Fb(1),s.Vc(t.GroupNumber)}}function P(t,e){if(1&t){const t=s.Zb();s.Yb(0,"tr"),s.Sc(1,B,2,1,"td",26),s.Yb(2,"td"),s.Uc(3),s.Xb(),s.Yb(4,"td"),s.Uc(5),s.Xb(),s.Yb(6,"td"),s.Uc(7),s.Xb(),s.Yb(8,"td"),s.Uc(9),s.Xb(),s.Yb(10,"td"),s.Uc(11),s.Xb(),s.Yb(12,"td"),s.Uc(13),s.nc(14,"date"),s.nc(15,"date"),s.Xb(),s.Yb(16,"td"),s.Uc(17),s.nc(18,"date"),s.nc(19,"date"),s.Xb(),s.Yb(20,"td"),s.Uc(21),s.Xb(),s.Yb(22,"td"),s.Yb(23,"span"),s.Uc(24),s.Xb(),s.Xb(),s.Yb(25,"td"),s.Yb(26,"span",57),s.Uc(27),s.nc(28,"currency"),s.Xb(),s.Xb(),s.Yb(29,"td"),s.Yb(30,"span",57),s.Uc(31),s.nc(32,"currency"),s.Xb(),s.Xb(),s.Yb(33,"td"),s.Yb(34,"span",57),s.Uc(35),s.nc(36,"currency"),s.Xb(),s.Xb(),s.Yb(37,"td"),s.Yb(38,"span",57),s.Uc(39),s.nc(40,"currency"),s.Xb(),s.Xb(),s.Yb(41,"td"),s.Yb(42,"span",57),s.Uc(43),s.Xb(),s.Xb(),s.Yb(44,"td"),s.Yb(45,"span",57),s.Uc(46),s.nc(47,"currency"),s.Xb(),s.Xb(),s.Yb(48,"td"),s.Yb(49,"span",57),s.Uc(50),s.nc(51,"currency"),s.Xb(),s.Xb(),s.Yb(52,"td"),s.Yb(53,"span",57),s.Uc(54),s.nc(55,"currency"),s.Xb(),s.Xb(),s.Yb(56,"td"),s.Yb(57,"span",57),s.Uc(58),s.nc(59,"currency"),s.Xb(),s.Xb(),s.Yb(60,"td"),s.Yb(61,"span",57),s.Uc(62),s.nc(63,"currency"),s.Xb(),s.Xb(),s.Yb(64,"td"),s.Yb(65,"span",57),s.Uc(66),s.nc(67,"currency"),s.Xb(),s.Xb(),s.Yb(68,"td"),s.Uc(69),s.Xb(),s.Yb(70,"td"),s.Yb(71,"span",57),s.Uc(72),s.nc(73,"currency"),s.Xb(),s.Xb(),s.Yb(74,"td"),s.Uc(75),s.nc(76,"date"),s.nc(77,"date"),s.Xb(),s.Yb(78,"td"),s.Uc(79),s.Xb(),s.Yb(80,"td"),s.Uc(81),s.Xb(),s.Yb(82,"td"),s.Uc(83),s.Xb(),s.Yb(84,"td"),s.Uc(85),s.Xb(),s.Yb(86,"td"),s.Uc(87),s.Xb(),s.Yb(88,"td"),s.Yb(89,"button",58),s.ic("click",function(){s.Lc(t);const n=e.$implicit;return s.mc().ShowInvoiceList(n.SlotBookingId,n.BookingNumber)}),s.Tb(90,"i",59),s.Uc(91,"Voucher List"),s.Xb(),s.Xb(),s.Xb()}if(2&t){const t=e.$implicit,n=s.mc();s.Fb(1),s.tc("ngIf","OPD"!=n.bookingtype),s.Fb(2),s.Vc(t.BookingNumber),s.Fb(2),s.Vc(t.Name),s.Fb(2),s.Vc(t.MRNo),s.Fb(2),s.Vc(t.ContactNumber),s.Fb(2),s.Vc(t.State),s.Fb(2),s.Vc("0001"==s.pc(14,32,t.PeriodFrom,"yyyy")?"":s.pc(15,35,t.PeriodFrom,n.customDateFormat.DEF_DATE)),s.Fb(4),s.Vc("0001"==s.pc(18,38,t.PeriodUpto,"yyyy")?"":s.pc(19,41,t.PeriodUpto,n.customDateFormat.DEF_DATE)),s.Fb(4),s.Vc(t.NoofDays),s.Fb(2),s.Hb(t.BookingStatus),s.Fb(1),s.Vc(t.BookingStatus),s.Fb(3),s.Vc(s.pc(28,44,t.RoomRentAmount,"INR")),s.Fb(4),s.Vc(s.pc(32,47,t.OtherTreatAmount,"INR")),s.Fb(4),s.Vc(s.pc(36,50,t.TotalAmount,"INR")),s.Fb(4),s.Vc(s.pc(40,53,t.DiscountAmount,"INR")),s.Fb(4),s.Vc(t.DiscountPercentage),s.Fb(3),s.Vc(s.pc(47,56,t.RoomRentDisAmount,"INR")),s.Fb(4),s.Vc(s.pc(51,59,t.OtherTreatDiscAmount,"INR")),s.Fb(4),s.Vc(s.pc(55,62,t.TransactionAmount,"INR")),s.Fb(4),s.Vc(s.pc(59,65,t.RefundableAmount,"INR")),s.Fb(4),s.Vc(s.pc(63,68,t.RefundAmount,"INR")),s.Fb(4),s.Vc(s.pc(67,71,t.BalanceTransactionAmount,"INR")),s.Fb(3),s.Vc(t.DebitVoucherNumber),s.Fb(3),s.Vc(s.pc(73,74,t.TaxInvoiceAmount,"INR")),s.Fb(3),s.Vc("0001"==s.pc(76,77,t.DebitVoucherDate,"yyyy")?"":s.pc(77,80,t.DebitVoucherDate,n.customDateFormat.DEF_DATE)),s.Fb(4),s.Vc(t.Remarks),s.Fb(2),s.Vc(t.RequestedBy),s.Fb(2),s.Vc(t.ReferredBy),s.Fb(2),s.Vc(t.Department),s.Fb(2),s.Vc(t.IsStaff)}}function _(t,e){if(1&t&&(s.Yb(0,"tr"),s.Yb(1,"td"),s.Uc(2,"Total"),s.Xb(),s.Yb(3,"td"),s.Yb(4,"span",57),s.Uc(5),s.nc(6,"currency"),s.Xb(),s.Xb(),s.Yb(7,"td"),s.Yb(8,"span",57),s.Uc(9),s.nc(10,"currency"),s.Xb(),s.Xb(),s.Yb(11,"td"),s.Yb(12,"span",57),s.Uc(13),s.nc(14,"currency"),s.Xb(),s.Xb(),s.Yb(15,"td"),s.Yb(16,"span",57),s.Uc(17),s.nc(18,"currency"),s.Xb(),s.Xb(),s.Tb(19,"td"),s.Yb(20,"td"),s.Yb(21,"span",57),s.Uc(22),s.nc(23,"currency"),s.Xb(),s.Xb(),s.Yb(24,"td"),s.Yb(25,"span",57),s.Uc(26),s.nc(27,"currency"),s.Xb(),s.Xb(),s.Yb(28,"td"),s.Yb(29,"span",57),s.Uc(30),s.nc(31,"currency"),s.Xb(),s.Xb(),s.Yb(32,"td"),s.Yb(33,"span",57),s.Uc(34),s.nc(35,"currency"),s.Xb(),s.Xb(),s.Yb(36,"td"),s.Yb(37,"span",57),s.Uc(38),s.nc(39,"currency"),s.Xb(),s.Xb(),s.Yb(40,"td"),s.Yb(41,"span",57),s.Uc(42),s.nc(43,"currency"),s.Xb(),s.Xb(),s.Tb(44,"td"),s.Yb(45,"td"),s.Yb(46,"span",57),s.Uc(47),s.nc(48,"currency"),s.Xb(),s.Xb(),s.Xb()),2&t){const t=s.mc();s.Fb(1),s.Gb("colspan","OPD"!=t.bookingtype?9:8),s.Fb(4),s.Vc(s.pc(6,12,t.totalRoomRentAmount,"INR")),s.Fb(4),s.Vc(s.pc(10,15,t.totalOtherTreatmentAmount,"INR")),s.Fb(4),s.Vc(s.pc(14,18,t.totalAmount,"INR")),s.Fb(4),s.Vc(s.pc(18,21,t.totalDiscountAmount,"INR")),s.Fb(5),s.Vc(s.pc(23,24,t.totalDiscountRoomAmount,"INR")),s.Fb(4),s.Vc(s.pc(27,27,t.totalDiscountOtherAmount,"INR")),s.Fb(4),s.Vc(s.pc(31,30,t.totalTranAmount,"INR")),s.Fb(4),s.Vc(s.pc(35,33,t.totalRefundableAmount,"INR")),s.Fb(4),s.Vc(s.pc(39,36,t.totalRefundAmount,"INR")),s.Fb(4),s.Vc(s.pc(43,39,t.totalBalanceTran,"INR")),s.Fb(5),s.Vc(s.pc(48,42,t.totalTaxInvoice,"INR"))}}function G(t,e){if(1&t&&(s.Yb(0,"div"),s.Tb(1,"app-individual-invoice-list",60),s.Xb()),2&t){const t=s.mc();s.Fb(1),s.tc("slotBookingId",t.SlotBookingIdSelectedId)("IsVisitor",t.IsVisitor)}}const E=function(){return["GroupNumber","BookingNumber","MRNo","Name","PaymentType","BookingStatus","TransactionAmount","TransactionId","StateName","InvoiceNumber","Remarks","ReferredBy","DebitVoucherNumber","UpdatedBy"]},H=function(){return{width:"90vw"}},j=[{path:"",component:(()=>{class t extends i.a{constructor(t,e,n,o,c,i,s){super(),this.cdRef=t,this.router=e,this._ConstantServices=n,this._MasterServices=o,this._ReportServices=c,this._UtilityService=i,this.datepipe=s,this.lsobjClinicMaster=JSON.parse(localStorage.getItem("objClinicMaster"))||null,this.customDateFormat=a.h,this.UserTypeCurre=localStorage.getItem("userTypeId"),this.clinicType=null,this.ClinicIdSelected=null,this.userTypes=a.s,this.bookingtype=null,this.today=new Date,this.rangeDates=[],this.MaxYear=(new Date).getFullYear()+2,this.Isdisabled=!1,this.searchtxt=null,this.filterByDate=null,this.totalAmount=0,this.totalTranAmount=0,this.totalRoomRentAmount=0,this.totalOtherTreatmentAmount=0,this.totalDiscountAmount=0,this.totalRefundableAmount=0,this.totalDiscountRoomAmount=0,this.totalDiscountOtherAmount=0,this.filteredValuesLength=0,this.voucherType=null,this.stlstvouchertype=[],this.totalRefundAmount=0,this.totalBalanceTran=0,this.totalTaxInvoice=0,this.ReportType="TI",this.TranDate=new Date,this.SlotBookingIdSelectedId=null,this.ShowInvoiceListModel=!1,this.ActionList=a.a,this.lstIAccess=[],this.lstIAccessStr=[],this.CustomerType="0",this.IsVisitor=!1,this.stlstbookingtype=[{name:"ALL",code:"BOTH"},{name:"IPD",code:"IPD"},{name:"OPD",code:"OPD"}],this.rangeDates=[new Date,new Date],this.getPageLevelAccess()}getPageLevelAccess(){var t,e,n=this.getUrlWithoutParams(),o=JSON.parse(localStorage.getItem("UerRoleAccess"))||[];(null==o?void 0:o.find(t=>t.MenuItemURL===n))&&(this.lstIAccess=null===(t=o.find(t=>t.MenuItemURL===n))||void 0===t?void 0:t.ActionIAccess,(null===(e=this.lstIAccess)||void 0===e?void 0:e.length)>0&&this.lstIAccess.map(t=>{this.lstIAccessStr.push(t.ActionId.toString())}))}getUrlWithoutParams(){let t=this.router.parseUrl(this.router.url);return t.queryParams={},t.fragment=null,t.toString()}ngOnInit(){var t;this._ConstantServices.ActiveMenuName="Tax Invoice Report",this.cdRef.detectChanges(),a.s.SuperAdmin!==localStorage.getItem("userTypeId")&&(this.ClinicIdSelected=localStorage.getItem("ClinicId"),this.clinicType=null===(t=this.lsobjClinicMaster)||void 0===t?void 0:t.ClinicType,this.bookingtype=this.clinicType,this.LoadTaxInvoiceReportList())}onselectedClinic(t){a.s.SuperAdmin===localStorage.getItem("userTypeId")&&(this.ClinicIdSelected=t.ClinicId,this.clinicType=null==t?void 0:t.ClinicType,this.bookingtype=this.clinicType),this.LoadTaxInvoiceReportList()}OnChangeBookingType(){this.LoadTaxInvoiceReportList()}OnChangeFilterType(){this.LoadTaxInvoiceReportList()}LoadTaxInvoiceReportList(){var t,e;if(this.totalAmount=0,this.totalTranAmount=0,this.totalRoomRentAmount=0,this.totalOtherTreatmentAmount=0,this.totalDiscountAmount=0,this.totalRefundAmount=0,this.totalRefundableAmount=0,this.totalDiscountRoomAmount=0,this.totalDiscountOtherAmount=0,this.totalBalanceTran=0,this.totalTaxInvoice=0,""!=this.ClinicIdSelected&&null!=this.ClinicIdSelected&&null!=this.ClinicIdSelected)if(""!=this.bookingtype&&null!=this.bookingtype&&null!=this.bookingtype)if(""!=(null===(t=this.searchtxt)||void 0===t?void 0:t.trim())&&null!=this.searchtxt&&null!=this.searchtxt||(this.searchtxt=""),null!=this.rangeDates[0]&&null!=this.rangeDates[0]&&(this.dFrom=this.datepipe.transform(this.rangeDates[0],"yyyy-MM-dd")),null!=this.rangeDates[1]&&null!=this.rangeDates[1]&&(this.dTo=this.datepipe.transform(this.rangeDates[1],"yyyy-MM-dd")),"RV"==this.ReportType)this.lstTaxInvoiceReport=[],this.filtr.nativeElement.value="",this.dataTable.reset(),this.filteredValuesLength=null===(e=this.lstTaxInvoiceReport)||void 0===e?void 0:e.length;else{let t={};t.clinicId=this.ClinicIdSelected,t.dFrom=new Date(this.datepipe.transform(this.dFrom,"yyyy-MM-dd")),t.dTo=new Date(this.datepipe.transform(this.dTo,"yyyy-MM-dd")),t.bookingtype=this.bookingtype,t.ReportType=this.ReportType,t.CustomerType=this.CustomerType,t.TranDate=new Date(this.datepipe.transform(this.TranDate,"yyyy-MM-dd")),this._UtilityService.showSpinner(),this.unsubscribe.add=this._ReportServices.GetTaxInvoiceReport(t).subscribe(t=>{var e;if(this._UtilityService.hideSpinner(),this.cdRef.detectChanges(),1==t.actionResult.success){var n=JSON.parse(t.actionResult.result);this.lstTaxInvoiceReport=n=n||[],this.filtr.nativeElement.value="",this.dataTable.reset(),this.filteredValuesLength=null===(e=this.lstTaxInvoiceReport)||void 0===e?void 0:e.length,this.totalAmount=this.lstTaxInvoiceReport.map(t=>t.TotalAmount).reduce(function(t,e){return t+e}),this.totalRefundableAmount=this.lstTaxInvoiceReport.map(t=>t.RefundableAmount).reduce(function(t,e){return t+e}),this.totalTranAmount=this.lstTaxInvoiceReport.map(t=>t.TransactionAmount).reduce(function(t,e){return t+e}),this.totalRoomRentAmount=this.lstTaxInvoiceReport.map(t=>t.RoomRentAmount).reduce(function(t,e){return t+e}),this.totalOtherTreatmentAmount=this.lstTaxInvoiceReport.map(t=>t.OtherTreatAmount).reduce(function(t,e){return t+e}),this.totalDiscountAmount=this.lstTaxInvoiceReport.map(t=>t.DiscountAmount).reduce(function(t,e){return t+e}),this.totalRefundAmount=this.lstTaxInvoiceReport.map(t=>t.RefundAmount).reduce(function(t,e){return t+e}),this.totalDiscountRoomAmount=this.lstTaxInvoiceReport.map(t=>t.RoomRentDisAmount).reduce(function(t,e){return t+e}),this.totalDiscountOtherAmount=this.lstTaxInvoiceReport.map(t=>t.OtherTreatDiscAmount).reduce(function(t,e){return t+e}),this.totalBalanceTran=this.lstTaxInvoiceReport.map(t=>t.BalanceTransactionAmount).reduce(function(t,e){return t+e}),this.totalTaxInvoice=this.lstTaxInvoiceReport.map(t=>t.TaxInvoiceAmount).reduce(function(t,e){return t+e}),this.cdRef.detectChanges()}else this.lstTaxInvoiceReport=[],this.totalAmount=0,this.totalDiscountAmount=0,this.totalOtherTreatmentAmount=0,this.totalRoomRentAmount=0,this.rowGroupMetadata={},this.cdRef.detectChanges()},t=>{this._UtilityService.hideSpinner(),this._UtilityService.showErrorAlert(t.message)})}else this._UtilityService.showWarningAlert("Please select Booking Type");else this._UtilityService.showWarningAlert("Please select center")}updateRowGroupMetaData(){if(this.rowGroupMetadata={},this.lstTaxInvoiceReport)for(let t=0;t<this.lstTaxInvoiceReport.length;t++){let e=this.lstTaxInvoiceReport[t].GroupNumber;0==t?this.rowGroupMetadata[e]={index:0,size:1}:e===this.lstTaxInvoiceReport[t-1].GroupNumber?this.rowGroupMetadata[e].size++:this.rowGroupMetadata[e]={index:t,size:1}}this.cdRef.detectChanges()}dateRangeChange(){this.rangeDates[0]&&this.rangeDates[1]&&(void 0!==this.calendar&&(this.calendar.overlayVisible=!1),this.LoadTaxInvoiceReportList())}ShowInvoiceList(t,e){this.IsVisitor=!1,this.SlotBookingIdSelectedId=t,null!=e&&null!=e&&""!=e||(this.IsVisitor=!0),this.ShowInvoiceListModel=!0}onFilter(t,e){this.filteredValuesLength=t.filteredValue.length,0==this.filteredValuesLength&&(this.totalAmount=0),this.totalAmount=t.filteredValue.map(t=>t.TransactionAmount).reduce(function(t,e){return t+e})}exportToItemExcel(){let t={reportname:"TaxInvoiceReport",filename:"TaxInvoiceReport"};t.clinicId=this.ClinicIdSelected,t.dFrom=new Date(this.datepipe.transform(this.rangeDates[0],"yyyy-MM-dd")),t.dTo=new Date(this.datepipe.transform(this.rangeDates[1],"yyyy-MM-dd")),t.bookingtype=this.bookingtype,t.ReportType=this.ReportType,t.CustomerType=this.CustomerType,t.TranDate=new Date(this.datepipe.transform(this.TranDate,"yyyy-MM-dd")),this._MasterServices.downloadReport(t)}}return t.\u0275fac=function(e){return new(e||t)(s.Sb(s.h),s.Sb(c.i),s.Sb(a.f),s.Sb(r.a),s.Sb(l.a),s.Sb(b.a),s.Sb(o.f))},t.\u0275cmp=s.Mb({type:t,selectors:[["app-tax-invoice-report"]],viewQuery:function(t,e){if(1&t&&(s.cd(v,1),s.cd(Y,1),s.cd(R,1)),2&t){let t;s.Hc(t=s.jc())&&(e.calendar=t.first),s.Hc(t=s.jc())&&(e.dataTable=t.first),s.Hc(t=s.jc())&&(e.filtr=t.first)}},features:[s.Cb],decls:37,vars:17,consts:[[1,"row","mt25"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"row","mb-2"],["class","col-md-3",4,"ngIf"],["class","col-md-2",4,"ngIf"],[1,"col-md-2"],[1,"form-group"],["for","",1,"b"],["name","ddlReportType",1,"form-control",3,"ngModel","ngModelChange","change"],["value","TI","selected","true"],["value","RV"],["value","CND"],["value","DTI"],["value","CN"],[1,"row"],["scrollHeight","calc(100vh - 275px)","responsiveLayout","scroll",3,"value","rowHover","globalFilterFields","scrollable","onFilter"],["dt",""],["pTemplate","caption"],["pTemplate","emptymessage"],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["header","Voucher List",3,"modal","visible","visibleChange"],[4,"ngIf"],[1,"col-md-3"],[3,"mode","onselectedClinic"],[1,"form-group","mb-0"],[1,"required"],["optionLabel","name","optionValue","code",3,"options","ngModel","ngModelOptions","style","ngModelChange","onChange",4,"ngIf"],["optionLabel","name","optionValue","code",3,"options","ngModel","ngModelOptions","ngModelChange","onChange"],["name","ddlCuType",1,"form-control",3,"ngModel","ngModelChange","change"],["value","0","selected","true"],["value","PTT"],["value","VST"],["selectionMode","range","inputId","icon","name","rangeDates",3,"monthNavigator","yearNavigator","yearRange","ngModel","ngModelOptions","showIcon","dateFormat","readonlyInput","ngModelChange","onSelect"],["calendar",""],["for","",1,"bold"],["inputId","icon",1,"iconcal",3,"maxDate","monthNavigator","yearNavigator","yearRange","ngModel","ngModelOptions","showIcon","dateFormat","readonlyInput","ngModelChange"],[1,"p-d-flex"],[1,"p-ml-left"],[1,"p-ml-auto"],["pButton","","title","Export Data","label"," ","class","p-button-outlined mr-2","icon","pi pi-download",3,"click",4,"ngIf"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["filtr",""],["pButton","","title","Export Data","label"," ","icon","pi pi-download",1,"p-button-outlined","mr-2",3,"click"],["style","width:130px",4,"ngIf"],[2,"width","135px"],[2,"width","125px"],[2,"width","95px"],[2,"width","100px"],[2,"width","130px"],[2,"width","120px"],[1,"price"],["type","button",1,"btn","mr4",2,"width","95px","padding","3px 6px","font-size","12px","border-radius","20px","background","#FF9041","color","#fff",3,"click"],[1,"pi","pi-book",2,"font-size","12px","color","#fff","padding-right","3px"],[3,"slotBookingId","IsVisitor"]],template:function(t,e){if(1&t){const t=s.Zb();s.Yb(0,"div",0),s.Yb(1,"div",1),s.Yb(2,"div",2),s.Yb(3,"div",3),s.Yb(4,"div",4),s.Sc(5,X,2,1,"div",5),s.Sc(6,F,7,1,"div",6),s.Yb(7,"div",7),s.Yb(8,"div",8),s.Yb(9,"label",9),s.Uc(10,"Report Type"),s.Xb(),s.Yb(11,"select",10),s.ic("ngModelChange",function(t){return e.ReportType=t})("change",function(){return e.LoadTaxInvoiceReportList()}),s.Yb(12,"option",11),s.Uc(13,"TI"),s.Xb(),s.Yb(14,"option",12),s.Uc(15,"RV"),s.Xb(),s.Yb(16,"option",13),s.Uc(17,"Cancel"),s.Xb(),s.Yb(18,"option",14),s.Uc(19,"Discounted TI"),s.Xb(),s.Yb(20,"option",15),s.Uc(21,"Credit Note"),s.Xb(),s.Xb(),s.Xb(),s.Xb(),s.Sc(22,S,10,1,"div",6),s.Sc(23,x,9,10,"div",5),s.Sc(24,M,6,11,"div",5),s.Xb(),s.Yb(25,"div",16),s.Yb(26,"div",1),s.Yb(27,"p-table",17,18),s.ic("onFilter",function(n){s.Lc(t);const o=s.Ic(28);return e.onFilter(n,o)}),s.Sc(29,V,9,2,"ng-template",19),s.Sc(30,w,3,1,"ng-template",20),s.Sc(31,L,31,1,"ng-template",21),s.Sc(32,O,60,1,"ng-template",22),s.Sc(33,P,92,83,"ng-template",23),s.Sc(34,_,49,45,"ng-template",24),s.Xb(),s.Xb(),s.Xb(),s.Xb(),s.Xb(),s.Xb(),s.Xb(),s.Yb(35,"p-dialog",25),s.ic("visibleChange",function(t){return e.ShowInvoiceListModel=t}),s.Sc(36,G,2,2,"div",26),s.Xb()}2&t&&(s.Fb(5),s.tc("ngIf",e.UserTypeCurre===e.userTypes.SuperAdmin),s.Fb(1),s.tc("ngIf","BOTH"==(null==e.clinicType?null:e.clinicType.toUpperCase())),s.Fb(5),s.tc("ngModel",e.ReportType),s.Fb(11),s.tc("ngIf","TI"==e.ReportType||"DTI"==e.ReportType),s.Fb(1),s.tc("ngIf","TI"==e.ReportType||"DTI"==e.ReportType),s.Fb(1),s.tc("ngIf","RV"==e.ReportType),s.Fb(3),s.tc("value",e.lstTaxInvoiceReport)("rowHover",!0)("globalFilterFields",s.yc(15,E))("scrollable",!0),s.Fb(8),s.Pc(s.yc(16,H)),s.tc("modal",!0)("visible",e.ShowInvoiceListModel),s.Fb(1),s.tc("ngIf",e.ShowInvoiceListModel))},directives:[o.p,u.x,u.o,u.r,u.s,u.A,d.c,p.i,h.a,m.a,T.a,g.a,f.a,y.b,I.a],pipes:[o.f,o.d],styles:[""]}),t})()}];let Z=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.Qb({type:t}),t.\u0275inj=s.Pb({imports:[[c.l.forChild(j)],c.l]}),t})();var z=n("kcK2"),J=n("T2Aj");let q=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.Qb({type:t}),t.\u0275inj=s.Pb({imports:[[o.c,Z,u.i,d.f,y.c,T.b,f.b,g.b,h.b,z.a,J.a]]}),t})()}}]);