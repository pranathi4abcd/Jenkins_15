(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{k0OL:function(t,e,c){"use strict";c.r(e),c.d(e,"YearlyRevenueReportModule",function(){return O});var n=c("ofXK"),i=c("tyNb"),o=c("Nach"),r=c("CwUn"),l=c("fXoL"),s=c("dcBc"),a=c("PtJb"),u=c("NLkC"),b=c("arFO"),d=c("3Pt+"),p=c("rEr+"),h=c("7zfz"),m=c("AAHA"),f=c("7kUa"),g=c("jIHw");const Y=["dt"],R=["filtr"];function v(t,e){if(1&t){const t=l.Zb();l.Yb(0,"div",6),l.Yb(1,"app-center-dropdown",20),l.ic("onclinicSelect",function(e){return l.Lc(t),l.mc().onclinicSelect(e)}),l.Xb(),l.Xb()}2&t&&(l.Fb(1),l.tc("mode","get"))}function X(t,e){if(1&t){const t=l.Zb();l.Yb(0,"button",29),l.ic("click",function(){return l.Lc(t),l.mc(2).exportToItemExcel()}),l.Xb()}}function S(t,e){if(1&t){const t=l.Zb();l.Yb(0,"div",21),l.Yb(1,"span",22),l.Uc(2),l.Xb(),l.Yb(3,"span",23),l.Sc(4,X,1,0,"button",24),l.Yb(5,"span",25),l.Tb(6,"i",26),l.Yb(7,"input",27,28),l.ic("input",function(e){return l.Lc(t),l.mc(),l.Ic(16).filterGlobal(e.target.value,"contains")}),l.Xb(),l.Xb(),l.Xb(),l.Xb()}if(2&t){const t=l.mc();l.Fb(2),l.Wc(" ",(null==t.lstReport?null:t.lstReport.length)>0?"Total Records: "+t.filteredValuesLength:""," "),l.Fb(2),l.tc("ngIf",(null==t.lstIAccessStr?null:t.lstIAccessStr.includes(t.ActionList.Download.toString()))&&(null==t.lstReport?null:t.lstReport.length)>0)}}function y(t,e){1&t&&(l.Yb(0,"tr"),l.Yb(1,"td"),l.Uc(2," No records found "),l.Xb(),l.Xb()),2&t&&(l.Fb(1),l.Gb("colspan",7))}function A(t,e){1&t&&(l.Yb(0,"colgroup"),l.Tb(1,"col",30),l.Tb(2,"col",31),l.Tb(3,"col",31),l.Tb(4,"col",31),l.Tb(5,"col",31),l.Tb(6,"col",31),l.Tb(7,"col",31),l.Tb(8,"col",31),l.Tb(9,"col",30),l.Xb())}function U(t,e){1&t&&(l.Yb(0,"tr"),l.Yb(1,"th"),l.Uc(2,"Month"),l.Xb(),l.Yb(3,"th"),l.Uc(4,"Revenue"),l.Xb(),l.Yb(5,"th"),l.Uc(6,"Refund Amount"),l.Xb(),l.Yb(7,"th"),l.Uc(8,"Discount Amount"),l.Xb(),l.Yb(9,"th"),l.Uc(10,"Occupied Rooms"),l.Xb(),l.Yb(11,"th"),l.Uc(12,"Occupied Nights"),l.Xb(),l.Yb(13,"th"),l.Uc(14,"Occupied Percentage"),l.Xb(),l.Yb(15,"th"),l.Uc(16,"No of Booking"),l.Xb(),l.Yb(17,"th"),l.Uc(18,"Total Rooms"),l.Xb(),l.Xb())}function I(t,e){if(1&t&&(l.Yb(0,"tr"),l.Yb(1,"td"),l.Uc(2),l.Xb(),l.Yb(3,"td"),l.Yb(4,"span",32),l.Uc(5),l.nc(6,"currency"),l.Xb(),l.Xb(),l.Yb(7,"td"),l.Yb(8,"span",32),l.Uc(9),l.nc(10,"currency"),l.Xb(),l.Xb(),l.Yb(11,"td"),l.Yb(12,"span",32),l.Uc(13),l.nc(14,"currency"),l.Xb(),l.Xb(),l.Yb(15,"td"),l.Uc(16),l.Xb(),l.Yb(17,"td"),l.Uc(18),l.Xb(),l.Yb(19,"td"),l.Uc(20),l.nc(21,"number"),l.Xb(),l.Yb(22,"td"),l.Uc(23),l.Xb(),l.Yb(24,"td"),l.Uc(25),l.Xb(),l.Xb()),2&t){const t=e.$implicit;l.Fb(2),l.Vc(t.MonthName),l.Fb(3),l.Vc(l.pc(6,9,t.Amount,"INR")),l.Fb(4),l.Vc(l.pc(10,12,t.RefundAmount,"INR")),l.Fb(4),l.Vc(l.pc(14,15,t.DiscountAmount,"INR")),l.Fb(3),l.Vc(t.OccupiedRoom),l.Fb(2),l.Vc(t.OccupiedNight),l.Fb(2),l.Vc(null==t.OccupiedPercentage?"":l.pc(21,18,t.OccupiedPercentage,"1.2-2")+"%"),l.Fb(3),l.Vc(t.BookingCount),l.Fb(2),l.Vc(t.TotalRoom)}}function F(t,e){if(1&t&&(l.Yb(0,"tr"),l.Yb(1,"td"),l.Uc(2,"Total"),l.Xb(),l.Yb(3,"td"),l.Yb(4,"span",32),l.Uc(5),l.nc(6,"currency"),l.Xb(),l.Xb(),l.Yb(7,"td"),l.Yb(8,"span",32),l.Uc(9),l.nc(10,"currency"),l.Xb(),l.Xb(),l.Yb(11,"td"),l.Yb(12,"span",32),l.Uc(13),l.nc(14,"currency"),l.Xb(),l.Xb(),l.Yb(15,"td"),l.Uc(16),l.Xb(),l.Yb(17,"td"),l.Uc(18),l.Xb(),l.Yb(19,"td"),l.Uc(20),l.Xb(),l.Yb(21,"td"),l.Uc(22),l.Xb(),l.Tb(23,"td"),l.Xb()),2&t){const t=l.mc();l.Fb(5),l.Vc(l.pc(6,7,t.totalAmount,"INR")),l.Fb(4),l.Vc(l.pc(10,10,t.RefundAmount,"INR")),l.Fb(4),l.Vc(l.pc(14,13,t.DiscountAmount,"INR")),l.Fb(3),l.Vc(t.totalRoom),l.Fb(2),l.Vc(t.totalNight),l.Fb(2),l.Vc(t.totalPercentage),l.Fb(2),l.Vc(t.totalBooking)}}const T=function(){return{width:"100%"}},w=function(){return{standalone:!0}},C=function(){return["MonthName"]},V=[{path:"",component:(()=>{class t extends r.a{constructor(t,e,c,n,i,r,l){super(),this.cdRef=t,this.router=e,this._ConstantServices=c,this._MasterServices=n,this._ReportServices=i,this._UtilityService=r,this.datepipe=l,this.UserTypeCurre=localStorage.getItem("userTypeId"),this.ClinicIdSelected=null,this.userTypes=o.s,this.customDateFormat=o.h,this.today=new Date,this.stlstYear=[],this.filteredValuesLength=0,this.totalAmount=0,this.RefundAmount=0,this.DiscountAmount=0,this.totalRoom=0,this.totalNight=0,this.totalBooking=0,this.totalPercentage="",this.ActionList=o.a,this.lstIAccess=[],this.lstIAccessStr=[],this._ConstantServices.ActiveMenuName="Yearly Revenue Report (Advance Booking)";for(var s=2022,a=(new Date).getFullYear()+2;a>=s;)this.stlstYear.push({name:s,code:s}),s+=1;this.year=(new Date).getFullYear(),this.getPageLevelAccess()}getPageLevelAccess(){var t,e,c=this.getUrlWithoutParams(),n=JSON.parse(localStorage.getItem("UerRoleAccess"))||[];(null==n?void 0:n.find(t=>t.MenuItemURL===c))&&(this.lstIAccess=null===(t=n.find(t=>t.MenuItemURL===c))||void 0===t?void 0:t.ActionIAccess,(null===(e=this.lstIAccess)||void 0===e?void 0:e.length)>0&&this.lstIAccess.map(t=>{this.lstIAccessStr.push(t.ActionId.toString())}))}getUrlWithoutParams(){let t=this.router.parseUrl(this.router.url);return t.queryParams={},t.fragment=null,t.toString()}ngOnInit(){o.s.SuperAdmin!==localStorage.getItem("userTypeId")&&(this.ClinicIdSelected=localStorage.getItem("ClinicId"),this.LoadYearlyRevenueReport())}onclinicSelect(t){this.ClinicIdSelected=t,this.LoadYearlyRevenueReport()}LoadYearlyRevenueReport(){""!=this.ClinicIdSelected&&null!=this.ClinicIdSelected&&null!=this.ClinicIdSelected?(this._UtilityService.showSpinner(),this.unsubscribe.add=this._ReportServices.GetYearlyRevenueReport(this.ClinicIdSelected,this.year).subscribe(t=>{var e,c;if(this._UtilityService.hideSpinner(),this.cdRef.detectChanges(),1==t.actionResult.success){var n=JSON.parse(t.actionResult.result);this.lstReport=n=n||[],this.totalAmount=this.lstReport.map(t=>t.Amount).reduce(function(t,e){return t+e}),this.RefundAmount=this.lstReport.map(t=>t.RefundAmount).reduce(function(t,e){return t+e}),this.DiscountAmount=this.lstReport.map(t=>t.DiscountAmount).reduce(function(t,e){return t+e}),this.totalRoom=this.lstReport.map(t=>t.OccupiedRoom).reduce(function(t,e){return t+e}),this.totalNight=this.lstReport.map(t=>t.OccupiedNight).reduce(function(t,e){return t+e}),this.totalBooking=this.lstReport.map(t=>t.BookingCount).reduce(function(t,e){return t+e});var i=this.lstReport.map(t=>t.OccupiedPercentage).reduce(function(t,e){return t+e}),o=null===(e=this.lstReport.filter(t=>null!=t.OccupiedPercentage))||void 0===e?void 0:e.length;o>0&&(this.totalPercentage=(i/o).toFixed(2)+"%"),this.filtr.nativeElement.value="",this.dataTable.reset(),this.filteredValuesLength=null===(c=this.lstReport)||void 0===c?void 0:c.length,this.cdRef.detectChanges()}else this.lstReport=[],this.totalAmount=0,this.totalRoom=0,this.totalNight=0,this.totalBooking=0,this.cdRef.detectChanges()},t=>{this._UtilityService.hideSpinner(),this._UtilityService.showErrorAlert(t.message)})):this._UtilityService.showWarningAlert("Please select center")}exportToItemExcel(){let t={reportname:"YearlyRevenueReport",filename:"YearlyRevenueReport"};t.clinicId=this.ClinicIdSelected,t.bookingStatus=this.year,this._MasterServices.downloadReport(t)}onFilter(t,e){this.filteredValuesLength=t.filteredValue.length,this.totalAmount=t.filteredValue.map(t=>t.Amount).reduce(function(t,e){return t+e}),this.totalRoom=t.filteredValue.map(t=>t.OccupiedRoom).reduce(function(t,e){return t+e}),this.totalNight=t.filteredValue.map(t=>t.OccupiedNight).reduce(function(t,e){return t+e}),this.totalBooking=t.filteredValue.map(t=>t.BookingCount).reduce(function(t,e){return t+e})}}return t.\u0275fac=function(e){return new(e||t)(l.Sb(l.h),l.Sb(i.i),l.Sb(o.f),l.Sb(s.a),l.Sb(a.a),l.Sb(u.a),l.Sb(n.f))},t.\u0275cmp=l.Mb({type:t,selectors:[["app-yearly-revenue-report"]],viewQuery:function(t,e){if(1&t&&(l.cd(Y,1),l.cd(R,1)),2&t){let t;l.Hc(t=l.jc())&&(e.dataTable=t.first),l.Hc(t=l.jc())&&(e.filtr=t.first)}},features:[l.Cb],decls:23,vars:13,consts:[[1,"row","mt25"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"row","mb-2"],["class","col-md-3",4,"ngIf"],[1,"col-md-3"],[1,"form-group"],["for",""],[1,"required"],["optionLabel","name","optionValue","code",3,"options","ngModel","ngModelOptions","ngModelChange","onChange"],[1,"row"],["scrollHeight","calc(100vh - 250px)","responsiveLayout","scroll",3,"value","rowHover","globalFilterFields","scrollable","onFilter"],["dt",""],["pTemplate","caption"],["pTemplate","emptymessage"],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[3,"mode","onclinicSelect"],[1,"p-d-flex"],[1,"p-ml-left"],[1,"p-ml-auto"],["pButton","","title","Export Data","label"," ","class","p-button-outlined mr-2","icon","pi pi-download",3,"click",4,"ngIf"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["filtr",""],["pButton","","title","Export Data","label"," ","icon","pi pi-download",1,"p-button-outlined","mr-2",3,"click"],[2,"width","100px"],[2,"width","150px"],[1,"price"]],template:function(t,e){if(1&t){const t=l.Zb();l.Yb(0,"div",0),l.Yb(1,"div",1),l.Yb(2,"div",2),l.Yb(3,"div",3),l.Yb(4,"div",4),l.Sc(5,v,2,1,"div",5),l.Yb(6,"div",6),l.Yb(7,"div",7),l.Yb(8,"label",8),l.Uc(9,"Select Year "),l.Yb(10,"span",9),l.Uc(11,"*"),l.Xb(),l.Xb(),l.Yb(12,"p-dropdown",10),l.ic("ngModelChange",function(t){return e.year=t})("onChange",function(){return e.LoadYearlyRevenueReport()}),l.Xb(),l.Xb(),l.Xb(),l.Xb(),l.Yb(13,"div",11),l.Yb(14,"div",1),l.Yb(15,"p-table",12,13),l.ic("onFilter",function(c){l.Lc(t);const n=l.Ic(16);return e.onFilter(c,n)}),l.Sc(17,S,9,2,"ng-template",14),l.Sc(18,y,3,1,"ng-template",15),l.Sc(19,A,10,0,"ng-template",16),l.Sc(20,U,19,0,"ng-template",17),l.Sc(21,I,26,21,"ng-template",18),l.Sc(22,F,24,16,"ng-template",19),l.Xb(),l.Xb(),l.Xb(),l.Xb(),l.Xb(),l.Xb(),l.Xb()}2&t&&(l.Fb(5),l.tc("ngIf",e.UserTypeCurre===e.userTypes.SuperAdmin),l.Fb(7),l.Pc(l.yc(10,T)),l.tc("options",e.stlstYear)("ngModel",e.year)("ngModelOptions",l.yc(11,w)),l.Fb(3),l.tc("value",e.lstReport)("rowHover",!0)("globalFilterFields",l.yc(12,C))("scrollable",!0))},directives:[n.p,b.a,d.o,d.r,p.c,h.i,m.a,f.a,g.b],pipes:[n.d,n.g],styles:[""]}),t.\u0275prov=l.Ob({token:t,factory:t.\u0275fac}),t})()}];let N=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.Qb({type:t}),t.\u0275inj=l.Pb({imports:[[i.l.forChild(V)],i.l]}),t})();var L=c("T2Aj");let O=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.Qb({type:t}),t.\u0275inj=l.Pb({imports:[[n.c,N,d.i,p.f,g.c,b.b,f.b,L.a]]}),t})()}}]);