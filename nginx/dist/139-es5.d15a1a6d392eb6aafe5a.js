!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,o=r(t);if(e){var i=r(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return c(this,n)}}function c(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{k0OL:function(c,r,i){"use strict";i.r(r),i.d(r,"YearlyRevenueReportModule",function(){return j});var l=i("ofXK"),u=i("tyNb"),a=i("Nach"),s=i("CwUn"),b=i("fXoL"),p=i("dcBc"),d=i("PtJb"),f=i("NLkC"),m=i("arFO"),h=i("3Pt+"),g=i("rEr+"),v=i("7zfz"),y=i("AAHA"),R=i("7kUa"),Y=i("jIHw"),S=["dt"],X=["filtr"];function A(t,e){if(1&t){var n=b.Zb();b.Yb(0,"div",6),b.Yb(1,"app-center-dropdown",20),b.ic("onclinicSelect",function(t){return b.Lc(n),b.mc().onclinicSelect(t)}),b.Xb(),b.Xb()}2&t&&(b.Fb(1),b.tc("mode","get"))}function U(t,e){if(1&t){var n=b.Zb();b.Yb(0,"button",29),b.ic("click",function(){return b.Lc(n),b.mc(2).exportToItemExcel()}),b.Xb()}}function I(t,e){if(1&t){var n=b.Zb();b.Yb(0,"div",21),b.Yb(1,"span",22),b.Uc(2),b.Xb(),b.Yb(3,"span",23),b.Sc(4,U,1,0,"button",24),b.Yb(5,"span",25),b.Tb(6,"i",26),b.Yb(7,"input",27,28),b.ic("input",function(t){return b.Lc(n),b.mc(),b.Ic(16).filterGlobal(t.target.value,"contains")}),b.Xb(),b.Xb(),b.Xb(),b.Xb()}if(2&t){var o=b.mc();b.Fb(2),b.Wc(" ",(null==o.lstReport?null:o.lstReport.length)>0?"Total Records: "+o.filteredValuesLength:""," "),b.Fb(2),b.tc("ngIf",(null==o.lstIAccessStr?null:o.lstIAccessStr.includes(o.ActionList.Download.toString()))&&(null==o.lstReport?null:o.lstReport.length)>0)}}function w(t,e){1&t&&(b.Yb(0,"tr"),b.Yb(1,"td"),b.Uc(2," No records found "),b.Xb(),b.Xb()),2&t&&(b.Fb(1),b.Gb("colspan",7))}function F(t,e){1&t&&(b.Yb(0,"colgroup"),b.Tb(1,"col",30),b.Tb(2,"col",31),b.Tb(3,"col",31),b.Tb(4,"col",31),b.Tb(5,"col",31),b.Tb(6,"col",31),b.Tb(7,"col",31),b.Tb(8,"col",31),b.Tb(9,"col",30),b.Xb())}function T(t,e){1&t&&(b.Yb(0,"tr"),b.Yb(1,"th"),b.Uc(2,"Month"),b.Xb(),b.Yb(3,"th"),b.Uc(4,"Revenue"),b.Xb(),b.Yb(5,"th"),b.Uc(6,"Refund Amount"),b.Xb(),b.Yb(7,"th"),b.Uc(8,"Discount Amount"),b.Xb(),b.Yb(9,"th"),b.Uc(10,"Occupied Rooms"),b.Xb(),b.Yb(11,"th"),b.Uc(12,"Occupied Nights"),b.Xb(),b.Yb(13,"th"),b.Uc(14,"Occupied Percentage"),b.Xb(),b.Yb(15,"th"),b.Uc(16,"No of Booking"),b.Xb(),b.Yb(17,"th"),b.Uc(18,"Total Rooms"),b.Xb(),b.Xb())}function O(t,e){if(1&t&&(b.Yb(0,"tr"),b.Yb(1,"td"),b.Uc(2),b.Xb(),b.Yb(3,"td"),b.Yb(4,"span",32),b.Uc(5),b.nc(6,"currency"),b.Xb(),b.Xb(),b.Yb(7,"td"),b.Yb(8,"span",32),b.Uc(9),b.nc(10,"currency"),b.Xb(),b.Xb(),b.Yb(11,"td"),b.Yb(12,"span",32),b.Uc(13),b.nc(14,"currency"),b.Xb(),b.Xb(),b.Yb(15,"td"),b.Uc(16),b.Xb(),b.Yb(17,"td"),b.Uc(18),b.Xb(),b.Yb(19,"td"),b.Uc(20),b.nc(21,"number"),b.Xb(),b.Yb(22,"td"),b.Uc(23),b.Xb(),b.Yb(24,"td"),b.Uc(25),b.Xb(),b.Xb()),2&t){var n=e.$implicit;b.Fb(2),b.Vc(n.MonthName),b.Fb(3),b.Vc(b.pc(6,9,n.Amount,"INR")),b.Fb(4),b.Vc(b.pc(10,12,n.RefundAmount,"INR")),b.Fb(4),b.Vc(b.pc(14,15,n.DiscountAmount,"INR")),b.Fb(3),b.Vc(n.OccupiedRoom),b.Fb(2),b.Vc(n.OccupiedNight),b.Fb(2),b.Vc(null==n.OccupiedPercentage?"":b.pc(21,18,n.OccupiedPercentage,"1.2-2")+"%"),b.Fb(3),b.Vc(n.BookingCount),b.Fb(2),b.Vc(n.TotalRoom)}}function k(t,e){if(1&t&&(b.Yb(0,"tr"),b.Yb(1,"td"),b.Uc(2,"Total"),b.Xb(),b.Yb(3,"td"),b.Yb(4,"span",32),b.Uc(5),b.nc(6,"currency"),b.Xb(),b.Xb(),b.Yb(7,"td"),b.Yb(8,"span",32),b.Uc(9),b.nc(10,"currency"),b.Xb(),b.Xb(),b.Yb(11,"td"),b.Yb(12,"span",32),b.Uc(13),b.nc(14,"currency"),b.Xb(),b.Xb(),b.Yb(15,"td"),b.Uc(16),b.Xb(),b.Yb(17,"td"),b.Uc(18),b.Xb(),b.Yb(19,"td"),b.Uc(20),b.Xb(),b.Yb(21,"td"),b.Uc(22),b.Xb(),b.Tb(23,"td"),b.Xb()),2&t){var n=b.mc();b.Fb(5),b.Vc(b.pc(6,7,n.totalAmount,"INR")),b.Fb(4),b.Vc(b.pc(10,10,n.RefundAmount,"INR")),b.Fb(4),b.Vc(b.pc(14,13,n.DiscountAmount,"INR")),b.Fb(3),b.Vc(n.totalRoom),b.Fb(2),b.Vc(n.totalNight),b.Fb(2),b.Vc(n.totalPercentage),b.Fb(2),b.Vc(n.totalBooking)}}var C,V,N,P=function(){return{width:"100%"}},L=function(){return{standalone:!0}},_=function(){return["MonthName"]},M=[{path:"",component:(C=function(c){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}(s,c);var r,i,l,u=o(s);function s(e,n,o,c,r,i,l){var b;t(this,s),(b=u.call(this)).cdRef=e,b.router=n,b._ConstantServices=o,b._MasterServices=c,b._ReportServices=r,b._UtilityService=i,b.datepipe=l,b.UserTypeCurre=localStorage.getItem("userTypeId"),b.ClinicIdSelected=null,b.userTypes=a.s,b.customDateFormat=a.h,b.today=new Date,b.stlstYear=[],b.filteredValuesLength=0,b.totalAmount=0,b.RefundAmount=0,b.DiscountAmount=0,b.totalRoom=0,b.totalNight=0,b.totalBooking=0,b.totalPercentage="",b.ActionList=a.a,b.lstIAccess=[],b.lstIAccessStr=[],b._ConstantServices.ActiveMenuName="Yearly Revenue Report (Advance Booking)";for(var p=2022,d=(new Date).getFullYear()+2;d>=p;)b.stlstYear.push({name:p,code:p}),p+=1;return b.year=(new Date).getFullYear(),b.getPageLevelAccess(),b}return r=s,(i=[{key:"getPageLevelAccess",value:function(){var t,e,n=this,o=this.getUrlWithoutParams(),c=JSON.parse(localStorage.getItem("UerRoleAccess"))||[];(null==c?void 0:c.find(function(t){return t.MenuItemURL===o}))&&(this.lstIAccess=null===(t=c.find(function(t){return t.MenuItemURL===o}))||void 0===t?void 0:t.ActionIAccess,(null===(e=this.lstIAccess)||void 0===e?void 0:e.length)>0&&this.lstIAccess.map(function(t){n.lstIAccessStr.push(t.ActionId.toString())}))}},{key:"getUrlWithoutParams",value:function(){var t=this.router.parseUrl(this.router.url);return t.queryParams={},t.fragment=null,t.toString()}},{key:"ngOnInit",value:function(){a.s.SuperAdmin!==localStorage.getItem("userTypeId")&&(this.ClinicIdSelected=localStorage.getItem("ClinicId"),this.LoadYearlyRevenueReport())}},{key:"onclinicSelect",value:function(t){this.ClinicIdSelected=t,this.LoadYearlyRevenueReport()}},{key:"LoadYearlyRevenueReport",value:function(){var t=this;""!=this.ClinicIdSelected&&null!=this.ClinicIdSelected&&null!=this.ClinicIdSelected?(this._UtilityService.showSpinner(),this.unsubscribe.add=this._ReportServices.GetYearlyRevenueReport(this.ClinicIdSelected,this.year).subscribe(function(e){var n,o;if(t._UtilityService.hideSpinner(),t.cdRef.detectChanges(),1==e.actionResult.success){var c=JSON.parse(e.actionResult.result);t.lstReport=c=c||[],t.totalAmount=t.lstReport.map(function(t){return t.Amount}).reduce(function(t,e){return t+e}),t.RefundAmount=t.lstReport.map(function(t){return t.RefundAmount}).reduce(function(t,e){return t+e}),t.DiscountAmount=t.lstReport.map(function(t){return t.DiscountAmount}).reduce(function(t,e){return t+e}),t.totalRoom=t.lstReport.map(function(t){return t.OccupiedRoom}).reduce(function(t,e){return t+e}),t.totalNight=t.lstReport.map(function(t){return t.OccupiedNight}).reduce(function(t,e){return t+e}),t.totalBooking=t.lstReport.map(function(t){return t.BookingCount}).reduce(function(t,e){return t+e});var r=t.lstReport.map(function(t){return t.OccupiedPercentage}).reduce(function(t,e){return t+e}),i=null===(n=t.lstReport.filter(function(t){return null!=t.OccupiedPercentage}))||void 0===n?void 0:n.length;i>0&&(t.totalPercentage=(r/i).toFixed(2)+"%"),t.filtr.nativeElement.value="",t.dataTable.reset(),t.filteredValuesLength=null===(o=t.lstReport)||void 0===o?void 0:o.length,t.cdRef.detectChanges()}else t.lstReport=[],t.totalAmount=0,t.totalRoom=0,t.totalNight=0,t.totalBooking=0,t.cdRef.detectChanges()},function(e){t._UtilityService.hideSpinner(),t._UtilityService.showErrorAlert(e.message)})):this._UtilityService.showWarningAlert("Please select center")}},{key:"exportToItemExcel",value:function(){var t={reportname:"YearlyRevenueReport",filename:"YearlyRevenueReport"};t.clinicId=this.ClinicIdSelected,t.bookingStatus=this.year,this._MasterServices.downloadReport(t)}},{key:"onFilter",value:function(t,e){this.filteredValuesLength=t.filteredValue.length,this.totalAmount=t.filteredValue.map(function(t){return t.Amount}).reduce(function(t,e){return t+e}),this.totalRoom=t.filteredValue.map(function(t){return t.OccupiedRoom}).reduce(function(t,e){return t+e}),this.totalNight=t.filteredValue.map(function(t){return t.OccupiedNight}).reduce(function(t,e){return t+e}),this.totalBooking=t.filteredValue.map(function(t){return t.BookingCount}).reduce(function(t,e){return t+e})}}])&&e(r.prototype,i),l&&e(r,l),s}(s.a),C.\u0275fac=function(t){return new(t||C)(b.Sb(b.h),b.Sb(u.i),b.Sb(a.f),b.Sb(p.a),b.Sb(d.a),b.Sb(f.a),b.Sb(l.f))},C.\u0275cmp=b.Mb({type:C,selectors:[["app-yearly-revenue-report"]],viewQuery:function(t,e){var n;1&t&&(b.cd(S,1),b.cd(X,1)),2&t&&(b.Hc(n=b.jc())&&(e.dataTable=n.first),b.Hc(n=b.jc())&&(e.filtr=n.first))},features:[b.Cb],decls:23,vars:13,consts:[[1,"row","mt25"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"row","mb-2"],["class","col-md-3",4,"ngIf"],[1,"col-md-3"],[1,"form-group"],["for",""],[1,"required"],["optionLabel","name","optionValue","code",3,"options","ngModel","ngModelOptions","ngModelChange","onChange"],[1,"row"],["scrollHeight","calc(100vh - 250px)","responsiveLayout","scroll",3,"value","rowHover","globalFilterFields","scrollable","onFilter"],["dt",""],["pTemplate","caption"],["pTemplate","emptymessage"],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[3,"mode","onclinicSelect"],[1,"p-d-flex"],[1,"p-ml-left"],[1,"p-ml-auto"],["pButton","","title","Export Data","label"," ","class","p-button-outlined mr-2","icon","pi pi-download",3,"click",4,"ngIf"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["filtr",""],["pButton","","title","Export Data","label"," ","icon","pi pi-download",1,"p-button-outlined","mr-2",3,"click"],[2,"width","100px"],[2,"width","150px"],[1,"price"]],template:function(t,e){if(1&t){var n=b.Zb();b.Yb(0,"div",0),b.Yb(1,"div",1),b.Yb(2,"div",2),b.Yb(3,"div",3),b.Yb(4,"div",4),b.Sc(5,A,2,1,"div",5),b.Yb(6,"div",6),b.Yb(7,"div",7),b.Yb(8,"label",8),b.Uc(9,"Select Year "),b.Yb(10,"span",9),b.Uc(11,"*"),b.Xb(),b.Xb(),b.Yb(12,"p-dropdown",10),b.ic("ngModelChange",function(t){return e.year=t})("onChange",function(){return e.LoadYearlyRevenueReport()}),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Yb(13,"div",11),b.Yb(14,"div",1),b.Yb(15,"p-table",12,13),b.ic("onFilter",function(t){b.Lc(n);var o=b.Ic(16);return e.onFilter(t,o)}),b.Sc(17,I,9,2,"ng-template",14),b.Sc(18,w,3,1,"ng-template",15),b.Sc(19,F,10,0,"ng-template",16),b.Sc(20,T,19,0,"ng-template",17),b.Sc(21,O,26,21,"ng-template",18),b.Sc(22,k,24,16,"ng-template",19),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb()}2&t&&(b.Fb(5),b.tc("ngIf",e.UserTypeCurre===e.userTypes.SuperAdmin),b.Fb(7),b.Pc(b.yc(10,P)),b.tc("options",e.stlstYear)("ngModel",e.year)("ngModelOptions",b.yc(11,L)),b.Fb(3),b.tc("value",e.lstReport)("rowHover",!0)("globalFilterFields",b.yc(12,_))("scrollable",!0))},directives:[l.p,m.a,h.o,h.r,g.c,v.i,y.a,R.a,Y.b],pipes:[l.d,l.g],styles:[""]}),C.\u0275prov=b.Ob({token:C,factory:C.\u0275fac}),C)}],x=((V=function e(){t(this,e)}).\u0275fac=function(t){return new(t||V)},V.\u0275mod=b.Qb({type:V}),V.\u0275inj=b.Pb({imports:[[u.l.forChild(M)],u.l]}),V),B=i("T2Aj"),j=((N=function e(){t(this,e)}).\u0275fac=function(t){return new(t||N)},N.\u0275mod=b.Qb({type:N}),N.\u0275inj=b.Pb({imports:[[l.c,x,h.i,g.f,Y.c,m.b,R.b,B.a]]}),N)}}])}();