!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var c=0;c<t.length;c++){var o=t[c];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var c,o=r(e);if(t){var i=r(this).constructor;c=Reflect.construct(o,arguments,i)}else c=o.apply(this,arguments);return n(this,c)}}function n(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[125],{dIPq:function(n,r,i){"use strict";i.r(r),i.d(r,"PatientOccupancyReportModule",function(){return B});var l=i("ofXK"),a=i("tyNb"),s=i("Nach"),u=i("CwUn"),p=i("fXoL"),d=i("dcBc"),b=i("PtJb"),h=i("7zAq"),m=i("NLkC"),f=i("Egam"),y=i("3Pt+"),v=i("arFO"),g=i("rEr+"),S=i("7zfz"),T=i("AAHA"),R=i("jIHw");function Y(e,t){if(1&e){var c=p.Zb();p.Yb(0,"div",6),p.Yb(1,"app-center-dropdown",30),p.ic("onclinicSelect",function(e){return p.Lc(c),p.mc().onclinicSelect(e)}),p.Xb(),p.Xb()}2&e&&(p.Fb(1),p.tc("mode","get"))}function I(e,t){if(1&e){var c=p.Zb();p.Yb(0,"button",35),p.ic("click",function(){return p.Lc(c),p.mc(2).exportToItemExcel()}),p.Xb()}}function C(e,t){if(1&e&&(p.Yb(0,"div",31),p.Yb(1,"span",32),p.Uc(2),p.Xb(),p.Yb(3,"span",33),p.Sc(4,I,1,0,"button",34),p.Xb(),p.Xb()),2&e){var c=p.mc();p.Fb(2),p.Wc(" ",(null==c.lstReport?null:c.lstReport.length)>0?"Total Records: "+c.filteredValuesLength:""," "),p.Fb(2),p.tc("ngIf",(null==c.lstIAccessStr?null:c.lstIAccessStr.includes(c.ActionList.Download.toString()))&&(null==c.lstReport?null:c.lstReport.length)>0)}}function X(e,t){if(1&e&&(p.Yb(0,"tr"),p.Yb(1,"td"),p.Uc(2," No records found "),p.Xb(),p.Xb()),2&e){var c=t.$implicit;p.Fb(1),p.Gb("colspan",null==c?null:c.length)}}function A(e,t){1&e&&p.Tb(0,"col",38)}function M(e,t){if(1&e&&(p.Yb(0,"colgroup"),p.Tb(1,"col",36),p.Tb(2,"col",37),p.Tb(3,"col",38),p.Tb(4,"col",38),p.Tb(5,"col",38),p.Tb(6,"col",38),p.Tb(7,"col",39),p.Sc(8,A,1,0,"col",40),p.Tb(9,"col",38),p.Xb()),2&e){var c=p.mc();p.Fb(8),p.tc("ngIf",c.UserTypeCurre===c.userTypes.SuperAdmin||c.UserTypeCurre===c.userTypes.Admin)}}function U(e,t){1&e&&(p.Yb(0,"th",42),p.Uc(1,"Revenue"),p.Xb())}function O(e,t){if(1&e&&(p.Yb(0,"tr"),p.Yb(1,"th",41),p.Uc(2,"Date"),p.Xb(),p.Yb(3,"th",42),p.Uc(4,"Occupancy(Head Count-M/F)"),p.Xb(),p.Yb(5,"th",42),p.Uc(6,"Occupied Rooms"),p.Xb(),p.Yb(7,"th",42),p.Uc(8,"Admitted HC(Rooms)"),p.Xb(),p.Yb(9,"th",42),p.Uc(10,"Act Admitted HC(Rooms)"),p.Xb(),p.Yb(11,"th",42),p.Uc(12,"Discharged HC(Rooms)"),p.Xb(),p.Yb(13,"th",42),p.Uc(14,"Act Discharged HC(Rooms)"),p.Xb(),p.Sc(15,U,2,0,"th",43),p.Yb(16,"th",42),p.Uc(17,"Occupied Percentage"),p.Xb(),p.Xb()),2&e){var c=p.mc();p.Fb(15),p.tc("ngIf",c.UserTypeCurre===c.userTypes.SuperAdmin||c.UserTypeCurre===c.userTypes.Admin)}}function P(e,t){if(1&e&&(p.Yb(0,"td",42),p.Uc(1),p.nc(2,"number"),p.nc(3,"number"),p.Xb()),2&e){var c=p.mc().$implicit,o=p.mc();p.Fb(1),p.Xc("\u20b9",p.pc(2,2,c.Revenue,"1.1-2")," ",o.isPreviousData?" | \u20b9"+(null!=c.previousRevenue?p.pc(3,5,c.previousRevenue,"1.2-2"):null==c?null:c.previousRevenue):"","")}}function w(e,t){if(1&e&&(p.Yb(0,"tr"),p.Yb(1,"td",41),p.Uc(2),p.nc(3,"date"),p.Xb(),p.Yb(4,"td",42),p.Uc(5),p.Xb(),p.Yb(6,"td",42),p.Uc(7),p.Xb(),p.Yb(8,"td",42),p.Uc(9),p.Xb(),p.Yb(10,"td",42),p.Uc(11),p.Xb(),p.Yb(12,"td",42),p.Uc(13),p.Xb(),p.Yb(14,"td",42),p.Uc(15),p.Xb(),p.Sc(16,P,4,8,"td",43),p.Yb(17,"td",42),p.Uc(18),p.nc(19,"number"),p.nc(20,"number"),p.Xb(),p.Xb()),2&e){var c=t.$implicit,o=p.mc();p.Fb(2),p.Vc(p.pc(3,22,c.Date,o.customDateFormat.DEF_DATE)),p.Fb(3),p.Zc("",c.TotalHCAll," (",c.TotalHCMale,"/",c.TotalHCFemale,") ",o.isPreviousData?" | "+c.previousTotalHCAll+"("+c.previousTotalHCMale+"/"+c.previousTotalHCFemale+")":"",""),p.Fb(2),p.Xc("",c.TotalRoomOccupancy," ",o.isPreviousData?" | "+c.previousTotalRoomOccupancy:"",""),p.Fb(2),p.Yc("",c.TotalHCCheckedIn," (",c.TotalRoomOccupiedToday,") ",o.isPreviousData?" | "+c.previousTotalHCCheckedIn+"("+c.previousTotalRoomOccupiedToday+")":"",""),p.Fb(2),p.Yc("",c.TotalActualHCCheckedIn," (",c.TotalActualRoomOccupiedToday,") ",o.isPreviousData?" | "+c.previousTotalActualHCCheckedIn+"("+c.previousTotalActualRoomOccupiedToday+")":"",""),p.Fb(2),p.Yc("",c.TotalHCCheckedOut," (",c.TotalRoomUnOccupiedToday,") ",o.isPreviousData?" | "+c.previousTotalHCCheckedOut+"("+c.previousTotalRoomUnOccupiedToday+")":"",""),p.Fb(2),p.Yc("",c.TotalActualHCCheckedOut," (",c.TotalActualRoomUnOccupiedToday,") ",o.isPreviousData?" | "+c.previousTotalActualHCCheckedOut+"("+c.previousTotalActualRoomUnOccupiedToday+")":"",""),p.Fb(1),p.tc("ngIf",o.UserTypeCurre===o.userTypes.SuperAdmin||o.UserTypeCurre===o.userTypes.Admin),p.Fb(2),p.Xc("",p.pc(19,25,c.OccupancyPercent,"1.2-2")," % ",o.isPreviousData?" | "+(null!=c.previousOccupancyPercent?p.pc(20,28,c.previousOccupancyPercent,"1.2-2"):c.previousOccupancyPercent)+" %":"","")}}function k(e,t){if(1&e&&(p.Yb(0,"tr"),p.Yb(1,"td",44),p.Uc(2,"Total"),p.Xb(),p.Yb(3,"td",42),p.Uc(4),p.nc(5,"number"),p.nc(6,"number"),p.Xb(),p.Tb(7,"td"),p.Xb()),2&e){var c=p.mc();p.Fb(1),p.tc("colSpan",c.UserTypeCurre===c.userTypes.SuperAdmin||c.UserTypeCurre===c.userTypes.Admin?"8":"7"),p.Fb(3),p.Xc("",p.pc(5,3,c.totaloccupancy,"1.2-2")," % ",c.isPreviousData?" | "+(0!=c.prevtotaloccupancy?p.pc(6,6,c.prevtotaloccupancy,"1.2-2"):c.prevtotaloccupancy)+" %":"","")}}var F,D,L,_=function(){return{standalone:!0}},H=function(){return{width:"100%"}},x=function(){return[]},V=[{path:"",component:(F=function(n){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(u,n);var r,i,l,a=o(u);function u(t,c,o,n,r,i,l,p){var d;e(this,u),(d=a.call(this)).cdRef=t,d.router=c,d._ConstantServices=o,d._MasterServices=n,d._ReportServices=r,d._RoomServices=i,d._UtilityService=l,d.datepipe=p,d.UserTypeCurre=localStorage.getItem("userTypeId"),d.ClinicIdSelected=null,d.userTypes=s.s,d.customDateFormat=s.h,d.today=new Date,d.lstRoomTypeMaster=[],d.lstRoomTypeMsterModelselectedItems=[],d.checkedItemArray=[],d.LstRoomTypeMsterModelSettings={},d.stlstYear=[],d.stlstMonth=[],d.filteredValuesLength=0,d.totaloccupancy=0,d.prevtotaloccupancy=0,d.isPreviousData=!1,d.ActionList=s.a,d.lstIAccess=[],d.lstIAccessStr=[],d._ConstantServices.ActiveMenuName="Patient Occupancy Report";for(var b=2022,h=(new Date).getFullYear()+2;h>=b;)d.stlstYear.push({name:b,code:b}),b+=1;return d.stlstMonth=d._ReportServices.Month,d.year=(new Date).getFullYear(),d.month=(new Date).getMonth()+1,d.getPageLevelAccess(),d}return r=u,(i=[{key:"getPageLevelAccess",value:function(){var e,t,c=this,o=this.getUrlWithoutParams(),n=JSON.parse(localStorage.getItem("UerRoleAccess"))||[];(null==n?void 0:n.find(function(e){return e.MenuItemURL===o}))&&(this.lstIAccess=null===(e=n.find(function(e){return e.MenuItemURL===o}))||void 0===e?void 0:e.ActionIAccess,(null===(t=this.lstIAccess)||void 0===t?void 0:t.length)>0&&this.lstIAccess.map(function(e){c.lstIAccessStr.push(e.ActionId.toString())}))}},{key:"getUrlWithoutParams",value:function(){var e=this.router.parseUrl(this.router.url);return e.queryParams={},e.fragment=null,e.toString()}},{key:"ngOnInit",value:function(){s.s.SuperAdmin!==localStorage.getItem("userTypeId")&&(this.ClinicIdSelected=localStorage.getItem("ClinicId"),this.LoadRoomTypeList(),this.GetPatientOccupancyReport())}},{key:"onItemSelect",value:function(e){var t;this.checkedItemArray=[];for(var c=0;c<(null===(t=this.lstRoomTypeMsterModelselectedItems)||void 0===t?void 0:t.length);c++)this.checkedItemArray.push({id:this.lstRoomTypeMsterModelselectedItems[c].RoomTypeMasterID})}},{key:"onDeSelect",value:function(e){var t;this.checkedItemArray=[];for(var c=0;c<(null===(t=this.lstRoomTypeMsterModelselectedItems)||void 0===t?void 0:t.length);c++)this.checkedItemArray.push({id:this.lstRoomTypeMsterModelselectedItems[c].RoomTypeMasterID})}},{key:"onSelectAll",value:function(e){this.checkedItemArray=[]}},{key:"onDeSelectAll",value:function(e){this.checkedItemArray=[]}},{key:"LoadRoomTypeList",value:function(){var e=this;this._UtilityService.showSpinner(),this.unsubscribe.add=this._RoomServices.GetRoomTypeMasterByClinic(this.ClinicIdSelected).subscribe(function(t){if(e._UtilityService.hideSpinner(),e.cdRef.detectChanges(),1==t.actionResult.success){var c=JSON.parse(t.actionResult.result);e.lstRoomTypeMaster=c=c||[],e.LstRoomTypeMsterModelSettings={idField:"RoomTypeMasterID",textField:"RoomTypeName",itemsShowLimit:1,allowSearchFilter:!0},e.lstRoomTypeMsterModelselectedItems=c,e.checkedItemArray=[],e.cdRef.detectChanges()}},function(t){e._UtilityService.hideSpinner(),e._UtilityService.showErrorAlert(t.message)})}},{key:"onclinicSelect",value:function(e){this.ClinicIdSelected=e,this.LoadRoomTypeList(),this.GetPatientOccupancyReport()}},{key:"GetPatientOccupancyReport",value:function(){var e=this;this.lstReport=[],""!=this.ClinicIdSelected&&null!=this.ClinicIdSelected&&null!=this.ClinicIdSelected?(this._UtilityService.showSpinner(),this.unsubscribe.add=this._ReportServices.GetPatientOccupancyReport(this.checkedItemArray,this.ClinicIdSelected,this.year,this.month,this.isPreviousData).subscribe(function(t){var c,o;if(e._UtilityService.hideSpinner(),e.cdRef.detectChanges(),1==t.actionResult.success){var n=JSON.parse(t.actionResult.result);e.lstReport=n=n||[],(null===(c=e.lstReport)||void 0===c?void 0:c.length)>0&&(e.totaloccupancy=e.lstReport.map(function(e){return e.OccupancyPercent}).reduce(function(e,t){return e+t}),e.totaloccupancy=e.totaloccupancy/e.lstReport.length,e.prevtotaloccupancy=e.lstReport.map(function(e){return e.previousOccupancyPercent}).reduce(function(e,t){return e+t}),e.prevtotaloccupancy=e.prevtotaloccupancy/e.lstReport.length),e.filteredValuesLength=null===(o=e.lstReport)||void 0===o?void 0:o.length,e.cdRef.detectChanges()}else e.lstReport=[],e.totaloccupancy=0,e.prevtotaloccupancy=0,e.cdRef.detectChanges()},function(t){e._UtilityService.hideSpinner(),e._UtilityService.showErrorAlert(t.message)})):this._UtilityService.showWarningAlert("Please select center")}},{key:"exportToItemExcel",value:function(){var e={reportname:"PatientOccupancyReport",filename:"PatientOccupancyReport"};e.clinicId=this.ClinicIdSelected,e.bookingStatus=this.year,e.month=this.month,e.lstCommonId=this.checkedItemArray,e.userTypeId=this.UserTypeCurre,e.isGrouped=this.isPreviousData,this._MasterServices.downloadReport(e)}},{key:"onFilter",value:function(e,t){var c;this.filteredValuesLength=e.filteredValue.length,(null===(c=e.filteredValue)||void 0===c?void 0:c.length)>0&&(this.totaloccupancy=e.filteredValue.map(function(e){return e.OccupancyPercent}).reduce(function(e,t){return e+t}),this.totaloccupancy=this.totaloccupancy/e.filteredValue.length),this.prevtotaloccupancy=e.filteredValue.map(function(e){return e.previousOccupancyPercent}).reduce(function(e,t){return e+t}),this.prevtotaloccupancy=this.prevtotaloccupancy/e.filteredValue.length}}])&&t(r.prototype,i),l&&t(r,l),u}(u.a),F.\u0275fac=function(e){return new(e||F)(p.Sb(p.h),p.Sb(a.i),p.Sb(s.f),p.Sb(d.a),p.Sb(b.a),p.Sb(h.a),p.Sb(m.a),p.Sb(l.f))},F.\u0275cmp=p.Mb({type:F,selectors:[["app-patient-occupancy-report"]],features:[p.Cb],decls:48,vars:27,consts:[[1,"row","mt25"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"row","mb-2"],["class","col-md-3",4,"ngIf"],[1,"col-md-3"],[1,"form-group"],["for",""],[1,"required"],[1,"multidropdowndiv"],["name","ddlRoomType",1,"form-control","multidropdownheight",3,"ngModelOptions","placeholder","settings","data","ngModel","ngModelChange","onSelect","onDeSelect","onSelectAll","onDeSelectAll"],[1,"col-md-2"],["optionLabel","name","optionValue","code",3,"options","ngModel","ngModelOptions","ngModelChange"],["optionLabel","Name","optionValue","Value",3,"options","ngModel","ngModelOptions","ngModelChange"],[1,"col-md-2","mt-9"],[1,"input-group"],[1,"mr-2"],["type","checkbox","name","chkisPreviousData",3,"ngModel","change","ngModelChange"],[1,"col-md-2","mt-7"],["type","button","matTooltip","Search",1,"btn","btn-new-primary",3,"click"],[1,"row"],["scrollHeight","calc(100vh - 300px)","responsiveLayout","scroll",3,"value","rowHover","globalFilterFields","scrollable","onFilter"],["dt",""],["pTemplate","caption"],["pTemplate","emptymessage"],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[3,"mode","onclinicSelect"],[1,"p-d-flex"],[1,"p-ml-left"],[1,"p-ml-auto"],["pButton","","title","Export Data","label"," ","class","p-button-outlined mr-2","icon","pi pi-download",3,"click",4,"ngIf"],["pButton","","title","Export Data","label"," ","icon","pi pi-download",1,"p-button-outlined","mr-2",3,"click"],[2,"width","90px"],[2,"width","200px"],[2,"width","150px"],[2,"width","160px"],["style","width:150px",4,"ngIf"],[1,"text-left"],[1,"text-center"],["class","text-center",4,"ngIf"],[3,"colSpan"]],template:function(e,t){if(1&e){var c=p.Zb();p.Yb(0,"div",0),p.Yb(1,"div",1),p.Yb(2,"div",2),p.Yb(3,"div",3),p.Yb(4,"div",4),p.Sc(5,Y,2,1,"div",5),p.Yb(6,"div",6),p.Yb(7,"div",7),p.Yb(8,"label",8),p.Uc(9,"Room Type"),p.Yb(10,"span",9),p.Uc(11,"*"),p.Xb(),p.Xb(),p.Yb(12,"div",10),p.Yb(13,"ng-multiselect-dropdown",11),p.ic("ngModelChange",function(e){return t.lstRoomTypeMsterModelselectedItems=e})("onSelect",function(e){return t.onItemSelect(e)})("onDeSelect",function(e){return t.onDeSelect(e)})("onSelectAll",function(e){return t.onSelectAll(e)})("onDeSelectAll",function(e){return t.onDeSelectAll(e)}),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Yb(14,"div",12),p.Yb(15,"div",7),p.Yb(16,"label",8),p.Uc(17,"Select Year "),p.Yb(18,"span",9),p.Uc(19,"*"),p.Xb(),p.Xb(),p.Yb(20,"p-dropdown",13),p.ic("ngModelChange",function(e){return t.year=e}),p.Xb(),p.Xb(),p.Xb(),p.Yb(21,"div",12),p.Yb(22,"div",7),p.Yb(23,"label",8),p.Uc(24,"Select Month"),p.Yb(25,"span",9),p.Uc(26,"*"),p.Xb(),p.Xb(),p.Yb(27,"p-dropdown",14),p.ic("ngModelChange",function(e){return t.month=e}),p.Xb(),p.Xb(),p.Xb(),p.Yb(28,"div",15),p.Yb(29,"div",7),p.Yb(30,"div",16),p.Yb(31,"label",17),p.Uc(32,"With Previous Data"),p.Xb(),p.Yb(33,"input",18),p.ic("change",function(){return t.GetPatientOccupancyReport()})("ngModelChange",function(e){return t.isPreviousData=e}),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Yb(34,"div",19),p.Yb(35,"div",7),p.Yb(36,"button",20),p.ic("click",function(){return t.GetPatientOccupancyReport()}),p.Uc(37," Search "),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Yb(38,"div",21),p.Yb(39,"div",1),p.Yb(40,"p-table",22,23),p.ic("onFilter",function(e){p.Lc(c);var o=p.Ic(41);return t.onFilter(e,o)}),p.Sc(42,C,5,2,"ng-template",24),p.Sc(43,X,3,1,"ng-template",25),p.Sc(44,M,10,1,"ng-template",26),p.Sc(45,O,18,1,"ng-template",27),p.Sc(46,w,21,31,"ng-template",28),p.Sc(47,k,8,9,"ng-template",29),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb()}2&e&&(p.Fb(5),p.tc("ngIf",t.UserTypeCurre===t.userTypes.SuperAdmin),p.Fb(8),p.tc("ngModelOptions",p.yc(21,_))("placeholder","All")("settings",t.LstRoomTypeMsterModelSettings)("data",t.lstRoomTypeMaster)("ngModel",t.lstRoomTypeMsterModelselectedItems),p.Fb(7),p.Pc(p.yc(22,H)),p.tc("options",t.stlstYear)("ngModel",t.year)("ngModelOptions",p.yc(23,_)),p.Fb(7),p.Pc(p.yc(24,H)),p.tc("options",t.stlstMonth)("ngModel",t.month)("ngModelOptions",p.yc(25,_)),p.Fb(6),p.tc("ngModel",t.isPreviousData),p.Fb(7),p.tc("value",t.lstReport)("rowHover",!0)("globalFilterFields",p.yc(26,x))("scrollable",!0))},directives:[l.p,f.a,y.o,y.r,v.a,y.a,g.c,S.i,T.a,R.b],pipes:[l.f,l.g],styles:[""]}),F.\u0275prov=p.Ob({token:F,factory:F.\u0275fac}),F)}],E=((D=function t(){e(this,t)}).\u0275fac=function(e){return new(e||D)},D.\u0275mod=p.Qb({type:D}),D.\u0275inj=p.Pb({imports:[[a.l.forChild(V)],a.l]}),D),j=i("7kUa"),N=i("lVkt"),G=i("T2Aj"),B=((L=function t(){e(this,t)}).\u0275fac=function(e){return new(e||L)},L.\u0275mod=p.Qb({type:L}),L.\u0275inj=p.Pb({imports:[[l.c,E,y.i,g.f,R.c,v.b,j.b,N.b,f.b.forRoot(),G.a]]}),L)}}])}();