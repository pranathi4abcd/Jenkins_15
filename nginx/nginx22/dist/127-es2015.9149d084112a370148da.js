(window.webpackJsonp=window.webpackJsonp||[]).push([[127],{F8rt:function(t,e,i){"use strict";i.r(e),i.d(e,"PrescriptionTreatmentReportModule",function(){return j});var s=i("ofXK"),n=i("tyNb"),a=i("Nach"),c=i("CwUn"),r=i("fXoL"),o=i("dcBc"),l=i("PtJb"),h=i("NLkC"),p=i("eO1q"),d=i("3Pt+"),b=i("rEr+"),u=i("7zfz"),m=i("AAHA"),g=i("jIHw"),f=i("7kUa");const y=["calendar"],S=["filtr"],v=["dt"];function P(t,e){if(1&t){const t=r.Zb();r.Yb(0,"div",22),r.Yb(1,"app-center-dropdown",23),r.ic("onselectedClinic",function(e){return r.Lc(t),r.mc().onselectedClinic(e)}),r.Xb(),r.Xb()}2&t&&(r.Fb(1),r.tc("mode","get"))}function I(t,e){if(1&t){const t=r.Zb();r.Yb(0,"button",32),r.ic("click",function(){return r.Lc(t),r.mc(2).exportToItemExcel()}),r.Xb()}}function F(t,e){if(1&t){const t=r.Zb();r.Yb(0,"div",24),r.Yb(1,"span",25),r.Uc(2),r.Xb(),r.Yb(3,"span",26),r.Yb(4,"button",27),r.ic("click",function(){return r.Lc(t),r.mc().GetTreatmentPrescriptionReport()}),r.Xb(),r.Sc(5,I,1,0,"button",28),r.Yb(6,"span",29),r.Tb(7,"i",30),r.Yb(8,"input",31),r.ic("input",function(e){r.Lc(t);const i=r.mc(),s=r.Ic(21);return i.onGlobalFilter(s,e)}),r.Xb(),r.Xb(),r.Xb(),r.Xb()}if(2&t){const t=r.mc();r.Fb(2),r.Wc(" ",(null==t.lstReport?null:t.lstReport.length)>0?"Total Records: "+t.filteredValuesLength:""," "),r.Fb(3),r.tc("ngIf",(null==t.lstIAccessStr?null:t.lstIAccessStr.includes(t.ActionList.Download.toString()))&&(null==t.lstReport?null:t.lstReport.length)>0)}}function T(t,e){1&t&&(r.Yb(0,"tr"),r.Yb(1,"td"),r.Uc(2," No records found "),r.Xb(),r.Xb()),2&t&&(r.Fb(1),r.Gb("colspan",3))}const C=function(t){return{width:t}};function Y(t,e){if(1&t&&(r.Yb(0,"th",34),r.Uc(1),r.Xb()),2&t){const t=e.$implicit;r.tc("ngStyle",r.zc(2,C,0===e.index?"50px":"150px")),r.Fb(1),r.Vc(t)}}function X(t,e){if(1&t&&(r.Yb(0,"tr"),r.Sc(1,Y,2,4,"th",33),r.Xb()),2&t){const t=r.mc();r.Fb(1),r.tc("ngForOf",t.reportHeaders)}}function w(t,e){if(1&t&&(r.Yb(0,"td",36),r.Uc(1),r.Xb()),2&t){const t=e.$implicit;r.Fb(1),r.Wc(" ",t," ")}}function D(t,e){if(1&t&&(r.Yb(0,"tr"),r.Yb(1,"td",35),r.Uc(2),r.Xb(),r.Yb(3,"td",36),r.Uc(4),r.Xb(),r.Yb(5,"td",36),r.Uc(6),r.nc(7,"date"),r.Xb(),r.Sc(8,w,2,1,"td",37),r.Yb(9,"td",36),r.Uc(10),r.Xb(),r.Xb()),2&t){const t=e.$implicit,i=e.rowIndex,s=r.mc();r.Fb(2),r.Vc(i+1),r.Fb(2),r.Vc(t.TreatmentName),r.Fb(2),r.Vc(r.pc(7,5,t.TreatmentDate,s.customDateFormat.DEF_DATE)),r.Fb(2),r.tc("ngForOf",s.getPhaseCounts(t)),r.Fb(2),r.Vc(t.Count)}}function R(t,e){if(1&t&&(r.Yb(0,"td",36),r.Uc(1),r.Xb()),2&t){const t=r.mc(2);r.Fb(1),r.Vc(t.phase1)}}function U(t,e){if(1&t&&(r.Yb(0,"td",36),r.Uc(1),r.Xb()),2&t){const t=r.mc(2);r.Fb(1),r.Vc(t.phase2)}}function A(t,e){if(1&t&&(r.Yb(0,"td",36),r.Uc(1),r.Xb()),2&t){const t=r.mc(2);r.Fb(1),r.Vc(t.phase3)}}function x(t,e){if(1&t&&(r.Yb(0,"td",36),r.Uc(1),r.Xb()),2&t){const t=r.mc(2);r.Fb(1),r.Vc(t.phase4)}}function k(t,e){if(1&t&&(r.Yb(0,"td",36),r.Uc(1),r.Xb()),2&t){const t=r.mc(2);r.Fb(1),r.Vc(t.phase5)}}function M(t,e){if(1&t&&(r.Yb(0,"td",36),r.Uc(1),r.Xb()),2&t){const t=r.mc(2);r.Fb(1),r.Vc(t.phase6)}}function V(t,e){if(1&t&&(r.Yb(0,"tr"),r.Yb(1,"td",38),r.Uc(2,"Total"),r.Xb(),r.Sc(3,R,2,1,"td",39),r.Sc(4,U,2,1,"td",39),r.Sc(5,A,2,1,"td",39),r.Sc(6,x,2,1,"td",39),r.Sc(7,k,2,1,"td",39),r.Sc(8,M,2,1,"td",39),r.Yb(9,"td",36),r.Uc(10),r.Xb(),r.Xb()),2&t){const t=r.mc();r.Fb(3),r.tc("ngIf",t.isPhase1),r.Fb(1),r.tc("ngIf",t.isPhase2),r.Fb(1),r.tc("ngIf",t.isPhase3),r.Fb(1),r.tc("ngIf",t.isPhase4),r.Fb(1),r.tc("ngIf",t.isPhase5),r.Fb(1),r.tc("ngIf",t.isPhase6),r.Fb(2),r.Vc(t.total)}}const L=function(){return["TreatmentName"]},O=[{path:"",component:(()=>{class t extends c.a{constructor(t,e,i,s,n,c,r){super(),this.cdRef=t,this.router=e,this._ConstantServices=i,this._MasterServices=s,this._ReportServices=n,this._UtilityService=c,this.datepipe=r,this.lsobjClinicMaster=JSON.parse(localStorage.getItem("objClinicMaster"))||null,this.UserTypeCurre=localStorage.getItem("userTypeId"),this.clinicType=null,this.ClinicIdSelected=null,this.userTypes=a.s,this.bookingtype=null,this.reportHeaders=[],this.filteredValuesLength=0,this.customDateFormat=a.h,this.today=new Date,this.maxDate=new Date(this.today),this.rangeDates=[],this.Isdisabled=!1,this.searchtxt=null,this.phaseSums={},this.coloumnsCount=0,this.phase1=0,this.phase2=0,this.phase3=0,this.phase4=0,this.phase5=0,this.phase6=0,this.isPhase1=!1,this.isPhase2=!1,this.isPhase3=!1,this.isPhase4=!1,this.isPhase5=!1,this.isPhase6=!1,this.total=0,this.ActionList=a.a,this.lstIAccess=[],this.lstIAccessStr=[],this.stlstbookingtype=[{name:"ALL",code:"BOTH"},{name:"IPD",code:"IPD"},{name:"OPD",code:"OPD"}],this.rangeDates=[new Date,new Date],this.MaxYear=this.today.getFullYear(),this.maxDate.setDate(this.maxDate.getDate()+7)}ngOnInit(){var t;this._ConstantServices.ActiveMenuName="Prescription Treatment Report",this.cdRef.detectChanges(),a.s.SuperAdmin!==localStorage.getItem("userTypeId")&&(this.ClinicIdSelected=localStorage.getItem("ClinicId"),this.clinicType=null===(t=this.lsobjClinicMaster)||void 0===t?void 0:t.ClinicType,this.bookingtype="IPD",this.GetTreatmentPrescriptionReport())}ngAfterViewChecked(){var t;0==(null===(t=this.lstIAccess)||void 0===t?void 0:t.length)&&this.getPageLevelAccess()}getPageLevelAccess(){var t,e,i=this.getUrlWithoutParams();"/common-dashboard"==i&&(i="/patient/health-seekeer-registration");var s=JSON.parse(localStorage.getItem("UerRoleAccess"))||[];(null==s?void 0:s.find(t=>t.MenuItemURL===i))&&(this.lstIAccess=null===(t=s.find(t=>t.MenuItemURL===i))||void 0===t?void 0:t.ActionIAccess,(null===(e=this.lstIAccess)||void 0===e?void 0:e.length)>0&&this.lstIAccess.map(t=>{this.lstIAccessStr.push(t.ActionId.toString())}))}getUrlWithoutParams(){let t=this.router.parseUrl(this.router.url);return t.queryParams={},t.fragment=null,t.toString()}onselectedClinic(t){a.s.SuperAdmin===localStorage.getItem("userTypeId")&&(this.ClinicIdSelected=t.ClinicId,this.clinicType=null==t?void 0:t.ClinicType,this.bookingtype=this.clinicType),this.GetTreatmentPrescriptionReport()}OnChangeBookingType(){this.GetTreatmentPrescriptionReport()}GetTreatmentPrescriptionReport(){this.phase1=0,this.phase2=0,this.phase3=0,this.phase4=0,this.phase5=0,this.phase6=0,this.isPhase1=!1,this.isPhase2=!1,this.isPhase3=!1,this.isPhase4=!1,this.isPhase5=!1,this.isPhase6=!1,this.total=0,""!=this.ClinicIdSelected&&null!=this.ClinicIdSelected&&null!=this.ClinicIdSelected?""!=this.bookingtype&&null!=this.bookingtype&&null!=this.bookingtype?(null!=this.rangeDates[0]&&null!=this.rangeDates[0]&&(this.dFrom=this.datepipe.transform(this.rangeDates[0],"yyyy-MM-dd")),null!=this.rangeDates[1]&&null!=this.rangeDates[1]&&(this.dTo=this.datepipe.transform(this.rangeDates[1],"yyyy-MM-dd")),this._UtilityService.showSpinner(),this.unsubscribe.add=this._ReportServices.GetTreatmentPrescriptionReport(this.ClinicIdSelected,this.dFrom,this.dTo,this.bookingtype).subscribe(t=>{var e,i;if(this._UtilityService.hideSpinner(),1==t.actionResult.success){var s=JSON.parse(t.actionResult.result);s=s||[],this.reportHeaders=JSON.parse(t.actionResult.result2),this.lstReport=s,this.filteredValuesLength=null===(e=this.lstReport)||void 0===e?void 0:e.length,void 0!==this.filtr&&(this.filtr.nativeElement.value="",this.dataTable.reset(),this.filteredValuesLength=null===(i=this.lstReport)||void 0===i?void 0:i.length),this.computePhaseSums(this.lstReport),this.cdRef.detectChanges()}else this.lstReport=[],this.cdRef.detectChanges()},t=>{this._UtilityService.hideSpinner(),this._UtilityService.showErrorAlert(t.message)})):this._UtilityService.showWarningAlert("Please select Booking Type"):this._UtilityService.showWarningAlert("Please select center")}dateRangeChange(){this.rangeDates[0]&&this.rangeDates[1]&&(void 0!==this.calendar&&(this.calendar.overlayVisible=!1),this.GetTreatmentPrescriptionReport())}getPhaseCounts(t){const e=this.reportHeaders.slice(3,-1);return this.coloumnsCount=this.reportHeaders.slice(3,-1).length,e.map(e=>t.PhaseCounts[e]||0)}exportToItemExcel(){let t={reportname:"TreatmentPrescriptionReport",filename:"TreatmentPrescriptionReport"};t.clinicId=this.ClinicIdSelected,t.dFrom=new Date(this.datepipe.transform(this.rangeDates[0],"yyyy-MM-dd")),t.dTo=new Date(this.datepipe.transform(this.rangeDates[1],"yyyy-MM-dd")),t.bookingtype=this.bookingtype,this._MasterServices.downloadReport(t)}onGlobalFilter(t,e){t.filterGlobal(e.target.value,"contains")}onFilter(t,e){this.filteredValuesLength=t.filteredValue.length,this.computePhaseSums(t.filteredValue)}computePhaseSums(t){if(t.length>0){const e=t[0].PhaseCounts?Object.keys(t[0].PhaseCounts):[];e.length>0&&(this.phase1=this.sumPhase(t,e[0]),this.isPhase1=!0),e.length>1&&(this.phase2=this.sumPhase(t,e[1]),this.isPhase2=!0),e.length>2&&(this.phase3=this.sumPhase(t,e[2]),this.isPhase3=!0),e.length>3&&(this.phase4=this.sumPhase(t,e[3]),this.isPhase4=!0),e.length>4&&(this.phase5=this.sumPhase(t,e[4]),this.isPhase5=!0),e.length>5&&(this.phase6=this.sumPhase(t,e[5]),this.isPhase6=!0),this.total=t.map(t=>t.Count).reduce((t,e)=>t+e,0)}}sumPhase(t,e){return t.map(t=>(t.PhaseCounts?t.PhaseCounts[e]:0)||0).reduce((t,e)=>t+e,0)}}return t.\u0275fac=function(e){return new(e||t)(r.Sb(r.h),r.Sb(n.i),r.Sb(a.f),r.Sb(o.a),r.Sb(l.a),r.Sb(h.a),r.Sb(s.f))},t.\u0275cmp=r.Mb({type:t,selectors:[["app-prescription-treatment-report"]],viewQuery:function(t,e){if(1&t&&(r.cd(y,1),r.cd(S,1),r.cd(v,1)),2&t){let t;r.Hc(t=r.jc())&&(e.calendar=t.first),r.Hc(t=r.jc())&&(e.filtr=t.first),r.Hc(t=r.jc())&&(e.dataTable=t.first)}},features:[r.Cb],decls:27,vars:15,consts:[[1,"row","mt25"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"row","mb-2"],["class","col-md-3",4,"ngIf"],[1,"col-auto"],[1,"form-group"],["for",""],[1,"required"],["selectionMode","range","inputId","icon","name","rangeDates",3,"monthNavigator","yearNavigator","yearRange","maxDate","ngModel","showIcon","dateFormat","readonlyInput","ngModelChange","onSelect"],["calendar",""],[1,"col-md-1","mt-7","mt10"],["type","button","matTooltip","Search",1,"btn","btn-new-primary",3,"click"],[1,"row"],["scrollHeight","calc(100vh - 275px)","responsiveLayout","scroll",1,"ColumnFilterTable",3,"value","rowHover","globalFilterFields","scrollable","onFilter"],["dt",""],["pTemplate","caption"],["pTemplate","emptymessage"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[1,"col-md-3"],[3,"mode","onselectedClinic"],[1,"p-d-flex"],[1,"p-ml-left"],[1,"p-ml-auto"],["pButton","","title","Refresh","label"," ","icon","pi pi-refresh",1,"p-button-outlined","mr-2",3,"click"],["pButton","","title","Export Data","label"," ","class","p-button-outlined mr-2","icon","pi pi-download",3,"click",4,"ngIf"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["pButton","","title","Export Data","label"," ","icon","pi pi-download",1,"p-button-outlined","mr-2",3,"click"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],[2,"width","50px"],[2,"width","150px"],["style","width: 150px;",4,"ngFor","ngForOf"],["colspan","3",2,"width","350px"],["style","width: 150px;",4,"ngIf"]],template:function(t,e){if(1&t){const t=r.Zb();r.Yb(0,"div",0),r.Yb(1,"div",1),r.Yb(2,"div",2),r.Yb(3,"div",3),r.Yb(4,"div",4),r.Sc(5,P,2,1,"div",5),r.Yb(6,"div",6),r.Yb(7,"div",7),r.Yb(8,"label",8),r.Uc(9,"From / To"),r.Yb(10,"span",9),r.Uc(11,"*"),r.Xb(),r.Xb(),r.Yb(12,"div"),r.Yb(13,"p-calendar",10,11),r.ic("ngModelChange",function(t){return e.rangeDates=t})("onSelect",function(){return e.dateRangeChange()}),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Yb(15,"div",12),r.Yb(16,"button",13),r.ic("click",function(){return e.GetTreatmentPrescriptionReport()}),r.Uc(17," Search "),r.Xb(),r.Xb(),r.Xb(),r.Yb(18,"div",14),r.Yb(19,"div",1),r.Yb(20,"p-table",15,16),r.ic("onFilter",function(i){r.Lc(t);const s=r.Ic(21);return e.onFilter(i,s)}),r.Sc(22,F,9,2,"ng-template",17),r.Sc(23,T,3,1,"ng-template",18),r.Sc(24,X,2,1,"ng-template",19),r.Sc(25,D,11,8,"ng-template",20),r.Sc(26,V,11,7,"ng-template",21),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb()}2&t&&(r.Fb(5),r.tc("ngIf",e.UserTypeCurre===e.userTypes.SuperAdmin),r.Fb(8),r.wc("yearRange","",e.customDateFormat.MinYear,":",e.MaxYear,""),r.tc("monthNavigator",!0)("yearNavigator",!0)("maxDate",e.maxDate)("ngModel",e.rangeDates)("showIcon",!0)("dateFormat",e.customDateFormat.CalendarFormat)("readonlyInput",!0),r.Fb(7),r.tc("value",e.lstReport)("rowHover",!0)("globalFilterFields",r.yc(14,L))("scrollable",!0))},directives:[s.p,p.a,d.o,d.r,b.c,u.i,m.a,g.b,f.a,s.o,s.q],pipes:[s.f],styles:[""]}),t})()}];let N=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.Qb({type:t}),t.\u0275inj=r.Pb({imports:[[n.l.forChild(O)],n.l]}),t})();var H=i("T2Aj"),_=i("lVkt"),G=i("arFO");let j=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.Qb({type:t}),t.\u0275inj=r.Pb({imports:[[s.c,N,d.i,b.f,g.c,G.b,f.b,p.b,H.a,_.b]]}),t})()}}]);