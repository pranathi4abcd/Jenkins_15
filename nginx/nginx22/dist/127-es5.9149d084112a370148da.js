!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,i=a(e);if(t){var s=a(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return r(this,n)}}function r(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[127],{F8rt:function(r,a,s){"use strict";s.r(a),s.d(a,"PrescriptionTreatmentReportModule",function(){return z});var o=s("ofXK"),c=s("tyNb"),l=s("Nach"),u=s("CwUn"),h=s("fXoL"),p=s("dcBc"),d=s("PtJb"),b=s("NLkC"),f=s("eO1q"),m=s("3Pt+"),g=s("rEr+"),v=s("7zfz"),y=s("AAHA"),S=s("jIHw"),P=s("7kUa"),I=["calendar"],F=["filtr"],T=["dt"];function w(e,t){if(1&e){var n=h.Zb();h.Yb(0,"div",22),h.Yb(1,"app-center-dropdown",23),h.ic("onselectedClinic",function(e){return h.Lc(n),h.mc().onselectedClinic(e)}),h.Xb(),h.Xb()}2&e&&(h.Fb(1),h.tc("mode","get"))}function C(e,t){if(1&e){var n=h.Zb();h.Yb(0,"button",32),h.ic("click",function(){return h.Lc(n),h.mc(2).exportToItemExcel()}),h.Xb()}}function Y(e,t){if(1&e){var n=h.Zb();h.Yb(0,"div",24),h.Yb(1,"span",25),h.Uc(2),h.Xb(),h.Yb(3,"span",26),h.Yb(4,"button",27),h.ic("click",function(){return h.Lc(n),h.mc().GetTreatmentPrescriptionReport()}),h.Xb(),h.Sc(5,C,1,0,"button",28),h.Yb(6,"span",29),h.Tb(7,"i",30),h.Yb(8,"input",31),h.ic("input",function(e){h.Lc(n);var t=h.mc(),i=h.Ic(21);return t.onGlobalFilter(i,e)}),h.Xb(),h.Xb(),h.Xb(),h.Xb()}if(2&e){var i=h.mc();h.Fb(2),h.Wc(" ",(null==i.lstReport?null:i.lstReport.length)>0?"Total Records: "+i.filteredValuesLength:""," "),h.Fb(3),h.tc("ngIf",(null==i.lstIAccessStr?null:i.lstIAccessStr.includes(i.ActionList.Download.toString()))&&(null==i.lstReport?null:i.lstReport.length)>0)}}function R(e,t){1&e&&(h.Yb(0,"tr"),h.Yb(1,"td"),h.Uc(2," No records found "),h.Xb(),h.Xb()),2&e&&(h.Fb(1),h.Gb("colspan",3))}var X=function(e){return{width:e}};function D(e,t){if(1&e&&(h.Yb(0,"th",34),h.Uc(1),h.Xb()),2&e){var n=t.$implicit;h.tc("ngStyle",h.zc(2,X,0===t.index?"50px":"150px")),h.Fb(1),h.Vc(n)}}function k(e,t){if(1&e&&(h.Yb(0,"tr"),h.Sc(1,D,2,4,"th",33),h.Xb()),2&e){var n=h.mc();h.Fb(1),h.tc("ngForOf",n.reportHeaders)}}function U(e,t){if(1&e&&(h.Yb(0,"td",36),h.Uc(1),h.Xb()),2&e){var n=t.$implicit;h.Fb(1),h.Wc(" ",n," ")}}function A(e,t){if(1&e&&(h.Yb(0,"tr"),h.Yb(1,"td",35),h.Uc(2),h.Xb(),h.Yb(3,"td",36),h.Uc(4),h.Xb(),h.Yb(5,"td",36),h.Uc(6),h.nc(7,"date"),h.Xb(),h.Sc(8,U,2,1,"td",37),h.Yb(9,"td",36),h.Uc(10),h.Xb(),h.Xb()),2&e){var n=t.$implicit,i=t.rowIndex,r=h.mc();h.Fb(2),h.Vc(i+1),h.Fb(2),h.Vc(n.TreatmentName),h.Fb(2),h.Vc(h.pc(7,5,n.TreatmentDate,r.customDateFormat.DEF_DATE)),h.Fb(2),h.tc("ngForOf",r.getPhaseCounts(n)),h.Fb(2),h.Vc(n.Count)}}function x(e,t){if(1&e&&(h.Yb(0,"td",36),h.Uc(1),h.Xb()),2&e){var n=h.mc(2);h.Fb(1),h.Vc(n.phase1)}}function O(e,t){if(1&e&&(h.Yb(0,"td",36),h.Uc(1),h.Xb()),2&e){var n=h.mc(2);h.Fb(1),h.Vc(n.phase2)}}function M(e,t){if(1&e&&(h.Yb(0,"td",36),h.Uc(1),h.Xb()),2&e){var n=h.mc(2);h.Fb(1),h.Vc(n.phase3)}}function V(e,t){if(1&e&&(h.Yb(0,"td",36),h.Uc(1),h.Xb()),2&e){var n=h.mc(2);h.Fb(1),h.Vc(n.phase4)}}function _(e,t){if(1&e&&(h.Yb(0,"td",36),h.Uc(1),h.Xb()),2&e){var n=h.mc(2);h.Fb(1),h.Vc(n.phase5)}}function L(e,t){if(1&e&&(h.Yb(0,"td",36),h.Uc(1),h.Xb()),2&e){var n=h.mc(2);h.Fb(1),h.Vc(n.phase6)}}function j(e,t){if(1&e&&(h.Yb(0,"tr"),h.Yb(1,"td",38),h.Uc(2,"Total"),h.Xb(),h.Sc(3,x,2,1,"td",39),h.Sc(4,O,2,1,"td",39),h.Sc(5,M,2,1,"td",39),h.Sc(6,V,2,1,"td",39),h.Sc(7,_,2,1,"td",39),h.Sc(8,L,2,1,"td",39),h.Yb(9,"td",36),h.Uc(10),h.Xb(),h.Xb()),2&e){var n=h.mc();h.Fb(3),h.tc("ngIf",n.isPhase1),h.Fb(1),h.tc("ngIf",n.isPhase2),h.Fb(1),h.tc("ngIf",n.isPhase3),h.Fb(1),h.tc("ngIf",n.isPhase4),h.Fb(1),h.tc("ngIf",n.isPhase5),h.Fb(1),h.tc("ngIf",n.isPhase6),h.Fb(2),h.Vc(n.total)}}var N,H,E,G=function(){return["TreatmentName"]},B=[{path:"",component:(N=function(r){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(u,r);var a,s,o,c=i(u);function u(t,n,i,r,a,s,o){var h;return e(this,u),(h=c.call(this)).cdRef=t,h.router=n,h._ConstantServices=i,h._MasterServices=r,h._ReportServices=a,h._UtilityService=s,h.datepipe=o,h.lsobjClinicMaster=JSON.parse(localStorage.getItem("objClinicMaster"))||null,h.UserTypeCurre=localStorage.getItem("userTypeId"),h.clinicType=null,h.ClinicIdSelected=null,h.userTypes=l.s,h.bookingtype=null,h.reportHeaders=[],h.filteredValuesLength=0,h.customDateFormat=l.h,h.today=new Date,h.maxDate=new Date(h.today),h.rangeDates=[],h.Isdisabled=!1,h.searchtxt=null,h.phaseSums={},h.coloumnsCount=0,h.phase1=0,h.phase2=0,h.phase3=0,h.phase4=0,h.phase5=0,h.phase6=0,h.isPhase1=!1,h.isPhase2=!1,h.isPhase3=!1,h.isPhase4=!1,h.isPhase5=!1,h.isPhase6=!1,h.total=0,h.ActionList=l.a,h.lstIAccess=[],h.lstIAccessStr=[],h.stlstbookingtype=[{name:"ALL",code:"BOTH"},{name:"IPD",code:"IPD"},{name:"OPD",code:"OPD"}],h.rangeDates=[new Date,new Date],h.MaxYear=h.today.getFullYear(),h.maxDate.setDate(h.maxDate.getDate()+7),h}return a=u,(s=[{key:"ngOnInit",value:function(){var e;this._ConstantServices.ActiveMenuName="Prescription Treatment Report",this.cdRef.detectChanges(),l.s.SuperAdmin!==localStorage.getItem("userTypeId")&&(this.ClinicIdSelected=localStorage.getItem("ClinicId"),this.clinicType=null===(e=this.lsobjClinicMaster)||void 0===e?void 0:e.ClinicType,this.bookingtype="IPD",this.GetTreatmentPrescriptionReport())}},{key:"ngAfterViewChecked",value:function(){var e;0==(null===(e=this.lstIAccess)||void 0===e?void 0:e.length)&&this.getPageLevelAccess()}},{key:"getPageLevelAccess",value:function(){var e,t,n=this,i=this.getUrlWithoutParams();"/common-dashboard"==i&&(i="/patient/health-seekeer-registration");var r=JSON.parse(localStorage.getItem("UerRoleAccess"))||[];(null==r?void 0:r.find(function(e){return e.MenuItemURL===i}))&&(this.lstIAccess=null===(e=r.find(function(e){return e.MenuItemURL===i}))||void 0===e?void 0:e.ActionIAccess,(null===(t=this.lstIAccess)||void 0===t?void 0:t.length)>0&&this.lstIAccess.map(function(e){n.lstIAccessStr.push(e.ActionId.toString())}))}},{key:"getUrlWithoutParams",value:function(){var e=this.router.parseUrl(this.router.url);return e.queryParams={},e.fragment=null,e.toString()}},{key:"onselectedClinic",value:function(e){l.s.SuperAdmin===localStorage.getItem("userTypeId")&&(this.ClinicIdSelected=e.ClinicId,this.clinicType=null==e?void 0:e.ClinicType,this.bookingtype=this.clinicType),this.GetTreatmentPrescriptionReport()}},{key:"OnChangeBookingType",value:function(){this.GetTreatmentPrescriptionReport()}},{key:"GetTreatmentPrescriptionReport",value:function(){var e=this;this.phase1=0,this.phase2=0,this.phase3=0,this.phase4=0,this.phase5=0,this.phase6=0,this.isPhase1=!1,this.isPhase2=!1,this.isPhase3=!1,this.isPhase4=!1,this.isPhase5=!1,this.isPhase6=!1,this.total=0,""!=this.ClinicIdSelected&&null!=this.ClinicIdSelected&&null!=this.ClinicIdSelected?""!=this.bookingtype&&null!=this.bookingtype&&null!=this.bookingtype?(null!=this.rangeDates[0]&&null!=this.rangeDates[0]&&(this.dFrom=this.datepipe.transform(this.rangeDates[0],"yyyy-MM-dd")),null!=this.rangeDates[1]&&null!=this.rangeDates[1]&&(this.dTo=this.datepipe.transform(this.rangeDates[1],"yyyy-MM-dd")),this._UtilityService.showSpinner(),this.unsubscribe.add=this._ReportServices.GetTreatmentPrescriptionReport(this.ClinicIdSelected,this.dFrom,this.dTo,this.bookingtype).subscribe(function(t){var n,i;if(e._UtilityService.hideSpinner(),1==t.actionResult.success){var r=JSON.parse(t.actionResult.result);r=r||[],e.reportHeaders=JSON.parse(t.actionResult.result2),e.lstReport=r,e.filteredValuesLength=null===(n=e.lstReport)||void 0===n?void 0:n.length,void 0!==e.filtr&&(e.filtr.nativeElement.value="",e.dataTable.reset(),e.filteredValuesLength=null===(i=e.lstReport)||void 0===i?void 0:i.length),e.computePhaseSums(e.lstReport),e.cdRef.detectChanges()}else e.lstReport=[],e.cdRef.detectChanges()},function(t){e._UtilityService.hideSpinner(),e._UtilityService.showErrorAlert(t.message)})):this._UtilityService.showWarningAlert("Please select Booking Type"):this._UtilityService.showWarningAlert("Please select center")}},{key:"dateRangeChange",value:function(){this.rangeDates[0]&&this.rangeDates[1]&&(void 0!==this.calendar&&(this.calendar.overlayVisible=!1),this.GetTreatmentPrescriptionReport())}},{key:"getPhaseCounts",value:function(e){var t=this.reportHeaders.slice(3,-1);return this.coloumnsCount=this.reportHeaders.slice(3,-1).length,t.map(function(t){return e.PhaseCounts[t]||0})}},{key:"exportToItemExcel",value:function(){var e={reportname:"TreatmentPrescriptionReport",filename:"TreatmentPrescriptionReport"};e.clinicId=this.ClinicIdSelected,e.dFrom=new Date(this.datepipe.transform(this.rangeDates[0],"yyyy-MM-dd")),e.dTo=new Date(this.datepipe.transform(this.rangeDates[1],"yyyy-MM-dd")),e.bookingtype=this.bookingtype,this._MasterServices.downloadReport(e)}},{key:"onGlobalFilter",value:function(e,t){e.filterGlobal(t.target.value,"contains")}},{key:"onFilter",value:function(e,t){this.filteredValuesLength=e.filteredValue.length,this.computePhaseSums(e.filteredValue)}},{key:"computePhaseSums",value:function(e){if(e.length>0){var t=e[0].PhaseCounts?Object.keys(e[0].PhaseCounts):[];t.length>0&&(this.phase1=this.sumPhase(e,t[0]),this.isPhase1=!0),t.length>1&&(this.phase2=this.sumPhase(e,t[1]),this.isPhase2=!0),t.length>2&&(this.phase3=this.sumPhase(e,t[2]),this.isPhase3=!0),t.length>3&&(this.phase4=this.sumPhase(e,t[3]),this.isPhase4=!0),t.length>4&&(this.phase5=this.sumPhase(e,t[4]),this.isPhase5=!0),t.length>5&&(this.phase6=this.sumPhase(e,t[5]),this.isPhase6=!0),this.total=e.map(function(e){return e.Count}).reduce(function(e,t){return e+t},0)}}},{key:"sumPhase",value:function(e,t){return e.map(function(e){return(e.PhaseCounts?e.PhaseCounts[t]:0)||0}).reduce(function(e,t){return e+t},0)}}])&&t(a.prototype,s),o&&t(a,o),u}(u.a),N.\u0275fac=function(e){return new(e||N)(h.Sb(h.h),h.Sb(c.i),h.Sb(l.f),h.Sb(p.a),h.Sb(d.a),h.Sb(b.a),h.Sb(o.f))},N.\u0275cmp=h.Mb({type:N,selectors:[["app-prescription-treatment-report"]],viewQuery:function(e,t){var n;1&e&&(h.cd(I,1),h.cd(F,1),h.cd(T,1)),2&e&&(h.Hc(n=h.jc())&&(t.calendar=n.first),h.Hc(n=h.jc())&&(t.filtr=n.first),h.Hc(n=h.jc())&&(t.dataTable=n.first))},features:[h.Cb],decls:27,vars:15,consts:[[1,"row","mt25"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"row","mb-2"],["class","col-md-3",4,"ngIf"],[1,"col-auto"],[1,"form-group"],["for",""],[1,"required"],["selectionMode","range","inputId","icon","name","rangeDates",3,"monthNavigator","yearNavigator","yearRange","maxDate","ngModel","showIcon","dateFormat","readonlyInput","ngModelChange","onSelect"],["calendar",""],[1,"col-md-1","mt-7","mt10"],["type","button","matTooltip","Search",1,"btn","btn-new-primary",3,"click"],[1,"row"],["scrollHeight","calc(100vh - 275px)","responsiveLayout","scroll",1,"ColumnFilterTable",3,"value","rowHover","globalFilterFields","scrollable","onFilter"],["dt",""],["pTemplate","caption"],["pTemplate","emptymessage"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[1,"col-md-3"],[3,"mode","onselectedClinic"],[1,"p-d-flex"],[1,"p-ml-left"],[1,"p-ml-auto"],["pButton","","title","Refresh","label"," ","icon","pi pi-refresh",1,"p-button-outlined","mr-2",3,"click"],["pButton","","title","Export Data","label"," ","class","p-button-outlined mr-2","icon","pi pi-download",3,"click",4,"ngIf"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["pButton","","title","Export Data","label"," ","icon","pi pi-download",1,"p-button-outlined","mr-2",3,"click"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],[2,"width","50px"],[2,"width","150px"],["style","width: 150px;",4,"ngFor","ngForOf"],["colspan","3",2,"width","350px"],["style","width: 150px;",4,"ngIf"]],template:function(e,t){if(1&e){var n=h.Zb();h.Yb(0,"div",0),h.Yb(1,"div",1),h.Yb(2,"div",2),h.Yb(3,"div",3),h.Yb(4,"div",4),h.Sc(5,w,2,1,"div",5),h.Yb(6,"div",6),h.Yb(7,"div",7),h.Yb(8,"label",8),h.Uc(9,"From / To"),h.Yb(10,"span",9),h.Uc(11,"*"),h.Xb(),h.Xb(),h.Yb(12,"div"),h.Yb(13,"p-calendar",10,11),h.ic("ngModelChange",function(e){return t.rangeDates=e})("onSelect",function(){return t.dateRangeChange()}),h.Xb(),h.Xb(),h.Xb(),h.Xb(),h.Yb(15,"div",12),h.Yb(16,"button",13),h.ic("click",function(){return t.GetTreatmentPrescriptionReport()}),h.Uc(17," Search "),h.Xb(),h.Xb(),h.Xb(),h.Yb(18,"div",14),h.Yb(19,"div",1),h.Yb(20,"p-table",15,16),h.ic("onFilter",function(e){h.Lc(n);var i=h.Ic(21);return t.onFilter(e,i)}),h.Sc(22,Y,9,2,"ng-template",17),h.Sc(23,R,3,1,"ng-template",18),h.Sc(24,k,2,1,"ng-template",19),h.Sc(25,A,11,8,"ng-template",20),h.Sc(26,j,11,7,"ng-template",21),h.Xb(),h.Xb(),h.Xb(),h.Xb(),h.Xb(),h.Xb(),h.Xb()}2&e&&(h.Fb(5),h.tc("ngIf",t.UserTypeCurre===t.userTypes.SuperAdmin),h.Fb(8),h.wc("yearRange","",t.customDateFormat.MinYear,":",t.MaxYear,""),h.tc("monthNavigator",!0)("yearNavigator",!0)("maxDate",t.maxDate)("ngModel",t.rangeDates)("showIcon",!0)("dateFormat",t.customDateFormat.CalendarFormat)("readonlyInput",!0),h.Fb(7),h.tc("value",t.lstReport)("rowHover",!0)("globalFilterFields",h.yc(14,G))("scrollable",!0))},directives:[o.p,f.a,m.o,m.r,g.c,v.i,y.a,S.b,P.a,o.o,o.q],pipes:[o.f],styles:[""]}),N)}],J=((H=function t(){e(this,t)}).\u0275fac=function(e){return new(e||H)},H.\u0275mod=h.Qb({type:H}),H.\u0275inj=h.Pb({imports:[[c.l.forChild(B)],c.l]}),H),W=s("T2Aj"),q=s("lVkt"),Z=s("arFO"),z=((E=function t(){e(this,t)}).\u0275fac=function(e){return new(e||E)},E.\u0275mod=h.Qb({type:E}),E.\u0275inj=h.Pb({imports:[[o.c,J,m.i,g.f,S.c,Z.b,P.b,f.b,W.a,q.b]]}),E)}}])}();