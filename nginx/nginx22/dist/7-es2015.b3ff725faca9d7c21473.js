(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{MHjV:function(e,t,s){"use strict";s.d(t,"a",function(){return W});var i=s("fXoL"),n=s("G+wY"),r=s("NLkC"),o=s("ofXK");function l(e,t){1&e&&(i.Yb(0,"th"),i.Uc(1,"Discount Amount"),i.Xb())}function c(e,t){if(1&e&&(i.Yb(0,"td"),i.Uc(1),i.Xb()),2&e){const e=i.mc().$implicit;i.Fb(1),i.Vc(e.DiscountAmount)}}function a(e,t){if(1&e&&(i.Yb(0,"tr"),i.Yb(1,"td"),i.Uc(2),i.Xb(),i.Yb(3,"td"),i.Uc(4),i.Xb(),i.Yb(5,"td"),i.Uc(6),i.Xb(),i.Yb(7,"td"),i.Uc(8),i.Xb(),i.Sc(9,c,2,1,"td",3),i.Yb(10,"td"),i.Uc(11),i.Xb(),i.Xb()),2&e){const e=t.$implicit,s=i.mc(2);i.Fb(2),i.Vc(null==e.Description?null:e.Description.split("~")[0]),i.Fb(2),i.Vc(e.MRP),i.Fb(2),i.Vc(e.Qty),i.Fb(2),i.Vc(e.GST),i.Fb(1),i.tc("ngIf","Frontdesk"==s.PayRequestFrom),i.Fb(2),i.Vc(e.PriceWithGST)}}function d(e,t){1&e&&(i.Yb(0,"td"),i.Uc(1,"\xa0"),i.Xb())}function b(e,t){if(1&e&&(i.Yb(0,"tr"),i.Yb(1,"td"),i.Uc(2,"Total Amount"),i.Xb(),i.Yb(3,"td"),i.Uc(4,"\xa0"),i.Xb(),i.Yb(5,"td"),i.Uc(6,"\xa0"),i.Xb(),i.Yb(7,"td"),i.Uc(8,"\xa0"),i.Xb(),i.Sc(9,d,2,0,"td",3),i.Yb(10,"td"),i.Uc(11),i.Xb(),i.Xb()),2&e){const e=i.mc(2);i.Fb(9),i.tc("ngIf","Frontdesk"==e.PayRequestFrom),i.Fb(2),i.Vc(e.TotalPaybleAmount)}}function h(e,t){1&e&&(i.Yb(0,"td"),i.Uc(1,"\xa0"),i.Xb())}function u(e,t){if(1&e&&(i.Yb(0,"tr"),i.Yb(1,"td"),i.Uc(2,"Bill Wise Discount %"),i.Xb(),i.Yb(3,"td"),i.Uc(4),i.Xb(),i.Yb(5,"td"),i.Uc(6,"\xa0"),i.Xb(),i.Sc(7,h,2,0,"td",3),i.Yb(8,"td"),i.Uc(9,"Amount"),i.Xb(),i.Yb(10,"td"),i.Uc(11),i.Xb(),i.Xb()),2&e){const e=i.mc(2);i.Fb(4),i.Vc(e.BillWiseDiscountPer),i.Fb(3),i.tc("ngIf","Frontdesk"==e.PayRequestFrom),i.Fb(4),i.Vc(e.BillwiseDiscountAmount)}}function m(e,t){1&e&&(i.Yb(0,"td"),i.Uc(1,"\xa0"),i.Xb())}function y(e,t){if(1&e&&(i.Yb(0,"tr"),i.Yb(1,"td"),i.Uc(2,"Credit Note Balance Used"),i.Xb(),i.Yb(3,"td"),i.Uc(4),i.Xb(),i.Yb(5,"td"),i.Uc(6,"\xa0"),i.Xb(),i.Sc(7,m,2,0,"td",3),i.Yb(8,"td"),i.Uc(9,"\xa0"),i.Xb(),i.Yb(10,"td"),i.Uc(11,"\xa0"),i.Xb(),i.Xb()),2&e){const e=i.mc(2);i.Fb(4),i.Vc(e.CreditNoteAmount),i.Fb(3),i.tc("ngIf","Frontdesk"==e.PayRequestFrom)}}function R(e,t){1&e&&(i.Yb(0,"td"),i.Uc(1,"\xa0"),i.Xb())}function P(e,t){1&e&&(i.Yb(0,"td"),i.Uc(1,"\xa0"),i.Xb())}function p(e,t){if(1&e&&(i.Yb(0,"tr"),i.Yb(1,"td"),i.Uc(2,"Receive Amount"),i.Xb(),i.Yb(3,"td"),i.Uc(4),i.Xb(),i.Yb(5,"td"),i.Uc(6,"\xa0"),i.Xb(),i.Yb(7,"td"),i.Uc(8,"\xa0"),i.Xb(),i.Sc(9,P,2,0,"td",3),i.Yb(10,"td"),i.Uc(11,"\xa0"),i.Xb(),i.Xb()),2&e){const e=i.mc(2);i.Fb(4),i.Vc(e.ReceiveAmont),i.Fb(5),i.tc("ngIf","Frontdesk"==e.PayRequestFrom)}}function S(e,t){if(1&e&&(i.Yb(0,"table",2),i.Yb(1,"thead"),i.Yb(2,"tr"),i.Yb(3,"th"),i.Uc(4,"Item Details"),i.Xb(),i.Yb(5,"th"),i.Uc(6,"Rate"),i.Xb(),i.Yb(7,"th"),i.Uc(8,"Qty"),i.Xb(),i.Yb(9,"th"),i.Uc(10,"GST"),i.Xb(),i.Sc(11,l,2,0,"th",3),i.Yb(12,"th"),i.Uc(13,"Net Amount"),i.Xb(),i.Xb(),i.Xb(),i.Yb(14,"tbody"),i.Sc(15,a,12,6,"tr",4),i.Sc(16,b,12,2,"tr",3),i.Sc(17,u,12,3,"tr",3),i.Sc(18,y,12,2,"tr",3),i.Yb(19,"tr"),i.Yb(20,"td"),i.Uc(21,"Net Payable"),i.Xb(),i.Yb(22,"td"),i.Uc(23),i.Xb(),i.Yb(24,"td"),i.Uc(25,"\xa0"),i.Xb(),i.Yb(26,"td"),i.Uc(27,"\xa0"),i.Xb(),i.Sc(28,R,2,0,"td",3),i.Yb(29,"td"),i.Uc(30,"\xa0"),i.Xb(),i.Xb(),i.Sc(31,p,12,2,"tr",3),i.Xb(),i.Xb()),2&e){const e=i.mc();i.Fb(11),i.tc("ngIf","Frontdesk"==e.PayRequestFrom),i.Fb(4),i.tc("ngForOf",e.ItemPriceRes),i.Fb(1),i.tc("ngIf","Frontdesk"==e.PayRequestFrom),i.Fb(1),i.tc("ngIf","Frontdesk"==e.PayRequestFrom),i.Fb(1),i.tc("ngIf",e.CreditNoteAmount>0),i.Fb(5),i.Vc(e.NetPaybleAmount),i.Fb(5),i.tc("ngIf","Frontdesk"==e.PayRequestFrom),i.Fb(3),i.tc("ngIf",e.IsPartialPayment)}}let W=(()=>{class e{constructor(e,t,s){this.cdRef=e,this._PatientServices=t,this._UtilityService=s,this.ReceiveAmont=0,this.TotalPaybleAmount=0,this.BillwiseDiscountAmount=0,this.NetPaybleAmount=0,this.WellnessWorldLineTransactionResponse={},this.Instruction={},this.WLOrderRes={},this.IsSelectedItem=!1,this.UserRes={},this.BillWiseDiscountPer=0,this.ReferredBy="",this.RequestedBy="",this.PayRequestFrom="Frontdesk",this.ActualNetPayble=0,this.IsPartialPayment=!1,this.CreditNoteNumber=null,this.CreditNoteAmount=0,this.GetPaymentStatusEmit=new i.o,this.NewOrderRes={},this.WellnessPaymentResDTO={}}ngOnInit(){}ngOnChanges(e){this.NewOrderRes=JSON.parse(JSON.stringify(this.WLOrderRes)),this.ItemPriceRes.map(e=>{this.TotalPaybleAmount=this.TotalPaybleAmount+e.PriceWithGST}),this.BillWiseDiscountPer>0?(this.BillwiseDiscountAmount=this.TotalPaybleAmount*this.BillWiseDiscountPer/100,this.NetPaybleAmount=this.TotalPaybleAmount-this.BillwiseDiscountAmount,this.NetPaybleAmount=this.NetPaybleAmount-(this.CreditNoteAmount>0?this.CreditNoteAmount:0)):(this.BillwiseDiscountAmount=0,this.NetPaybleAmount=this.TotalPaybleAmount,this.NetPaybleAmount=this.NetPaybleAmount-(this.CreditNoteAmount>0?this.CreditNoteAmount:0))}initializePayment(){$.pnCheckout({tarCall:!1,features:{showPGResponseMsg:!0,enableAbortResponse:!0,enableExpressPay:!0,enableNewWindowFlow:!0},consumerData:{deviceId:"WEBSH2",token:this.NewOrderRes.token,returnUrl:"",paymentMode:"all",responseHandler:e=>{var t,s,i,n,r,o,l,c,a;e&&e.paymentMethod&&e.paymentMethod.paymentTransaction&&e.paymentMethod.paymentTransaction.statusCode&&("0300"===e.paymentMethod.paymentTransaction.statusCode?(this.WellnessWorldLineTransactionResponse=e.paymentMethod.paymentTransaction,this.WellnessWorldLineTransactionResponse.merchantTransactionIdentifier=e.merchantTransactionIdentifier,this.WellnessWorldLineTransactionResponse.stringResponse=e.stringResponse,this.WellnessWorldLineTransactionResponse.SlotBookingId=null===(t=this.NewOrderRes)||void 0===t?void 0:t.SlotBookingId,this.WellnessWorldLineTransactionResponse.ClinicId=null===(s=this.NewOrderRes)||void 0===s?void 0:s.ClinicId,this.WellnessWorldLineTransactionResponse.UserId=null===(i=this.NewOrderRes)||void 0===i?void 0:i.UserId,this.WellnessPaymentResDTO.ModifiedBy=localStorage.getItem("userId"),this.WellnessPaymentResDTO.CreditNoteNumber=this.CreditNoteNumber,this.WellnessPaymentResDTO.CreditNoteAmount=this.CreditNoteAmount,1==this.IsSelectedItem?(this.WellnessPaymentResDTO.WellnessWorldLineTransactionResponse=this.WellnessWorldLineTransactionResponse,this.WellnessPaymentResDTO.ItemPriceRes=this.ItemPriceRes,this.WellnessPaymentResDTO.BillWiseDiscountPer=this.BillWiseDiscountPer,this.WellnessPaymentResDTO.ReferredBy=this.ReferredBy,this.WellnessPaymentResDTO.RequestedBy=this.RequestedBy,this.WellnessPaymentResDTO.NetPayble=this.nullToZeroConverter(this.NewOrderRes.amount),this.WellnessPaymentResDTO.PackageMapping=this.PackageMapping,this._UtilityService.showSpinner(),this._PatientServices.AddWorldLineTransactionResponseWellnessSelected(this.WellnessPaymentResDTO,this.SlotBookingIdSelected).subscribe(e=>{this._UtilityService.hideSpinner(),this.GetPaymentStatusEmit.emit("Success~"+e.actionResult.stringVal),this._UtilityService.showSuccessAlert(e.actionResult.errMsg)},e=>{this._UtilityService.hideSpinner(),this._UtilityService.showErrorAlert(e.message)})):(this.WellnessPaymentResDTO.WellnessWorldLineTransactionResponse=this.WellnessWorldLineTransactionResponse,this.WellnessPaymentResDTO.ItemPriceRes=this.ItemPriceRes,this.WellnessPaymentResDTO.BillWiseDiscountPer=this.BillWiseDiscountPer,this.WellnessPaymentResDTO.ReferredBy=this.ReferredBy,this.WellnessPaymentResDTO.RequestedBy=this.RequestedBy,this.WellnessPaymentResDTO.NetPayble=this.nullToZeroConverter(this.NewOrderRes.amount),this.WellnessPaymentResDTO.ActualNetPayble=this.nullToZeroConverter(this.ActualNetPayble),this.WellnessPaymentResDTO.PackageMapping=this.PackageMapping,this._UtilityService.showSpinner(),this._PatientServices.AddWorldLineTransactionResponseWellness(this.WellnessPaymentResDTO,this.SlotBookingIdSelected).subscribe(e=>{this._UtilityService.hideSpinner(),this.GetPaymentStatusEmit.emit("Success~"),this._UtilityService.showSuccessAlert(e.actionResult.errMsg)},e=>{this._UtilityService.hideSpinner(),this._UtilityService.showErrorAlert(e.message)}))):"0398"===e.paymentMethod.paymentTransaction.statusCode?(this.WellnessWorldLineTransactionResponse=e.paymentMethod.paymentTransaction,this.WellnessWorldLineTransactionResponse.merchantTransactionIdentifier=e.merchantTransactionIdentifier,this.WellnessWorldLineTransactionResponse.stringResponse=e.stringResponse,this.WellnessWorldLineTransactionResponse.SlotBookingId=null===(n=this.NewOrderRes)||void 0===n?void 0:n.SlotBookingId,this.WellnessWorldLineTransactionResponse.ClinicId=null===(r=this.NewOrderRes)||void 0===r?void 0:r.ClinicId,this.WellnessWorldLineTransactionResponse.UserId=null===(o=this.NewOrderRes)||void 0===o?void 0:o.UserId,this._UtilityService.showSpinner(),this._PatientServices.InsertUpdateWellnessWorldLineOrder(this.WellnessWorldLineTransactionResponse).subscribe(e=>{this._UtilityService.hideSpinner(),this._UtilityService.showSuccessAlert(e.actionResult.errMsg)},e=>{this._UtilityService.hideSpinner(),this._UtilityService.showErrorAlert(e.message)})):(this.WellnessWorldLineTransactionResponse=e.paymentMethod.paymentTransaction,this.WellnessWorldLineTransactionResponse.merchantTransactionIdentifier=e.merchantTransactionIdentifier,this.WellnessWorldLineTransactionResponse.stringResponse=e.stringResponse,this.WellnessWorldLineTransactionResponse.SlotBookingId=null===(l=this.NewOrderRes)||void 0===l?void 0:l.SlotBookingId,this.WellnessWorldLineTransactionResponse.ClinicId=null===(c=this.NewOrderRes)||void 0===c?void 0:c.ClinicId,this.WellnessWorldLineTransactionResponse.UserId=null===(a=this.NewOrderRes)||void 0===a?void 0:a.UserId,console.log("Payment Error:",this.WellnessWorldLineTransactionResponse),this._UtilityService.showSpinner(),this._PatientServices.InsertUpdateWellnessWorldLineOrder(this.WellnessWorldLineTransactionResponse).subscribe(t=>{this._UtilityService.hideSpinner(),this._UtilityService.showErrorAlert(e.paymentMethod.paymentTransaction.errorMessage)},e=>{this._UtilityService.hideSpinner(),this._UtilityService.showErrorAlert(e.message)})))},checkoutElement:"",merchantLogoUrl:"../../../../assets/images/om-logo.png",merchantId:this.NewOrderRes.merchantId,currency:"INR",consumerId:this.NewOrderRes.consumerId,consumerMobileNo:"",consumerEmailId:"",txnId:this.NewOrderRes.txnId,items:[{itemId:this.NewOrderRes.SchemeCode,amount:this.NewOrderRes.amount,comAmt:"0"}],customStyle:{PRIMARY_COLOR_CODE:"#2DB163",SECONDARY_COLOR_CODE:"#FFFFFF",BUTTON_COLOR_CODE_1:"#2DB163",BUTTON_COLOR_CODE_2:"#FFFFFF"},cartDescription:this.UserRes.MRNo+"~"+this.UserRes.FullName+"~"+this.UserRes.ContactNumber,debitStartDate:"07-06-2024",debitEndDate:"07-06-2054",maxAmount:this.NewOrderRes.amount,amountType:"F",frequency:"ADHO"}})}nullToZeroConverter(e){return null==e||null==e||""==e||"Infinity"==e||"NaN"==e||isNaN(parseFloat(e))?0:parseFloat(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(i.h),i.Sb(n.a),i.Sb(r.a))},e.\u0275cmp=i.Mb({type:e,selectors:[["app-worldline"]],inputs:{WLOrderRes:"WLOrderRes",SlotBookingIdSelected:"SlotBookingIdSelected",ItemPriceRes:"ItemPriceRes",IsSelectedItem:"IsSelectedItem",UserRes:"UserRes",BillWiseDiscountPer:"BillWiseDiscountPer",ReferredBy:"ReferredBy",RequestedBy:"RequestedBy",PayRequestFrom:"PayRequestFrom",ActualNetPayble:"ActualNetPayble",IsPartialPayment:"IsPartialPayment",CreditNoteNumber:"CreditNoteNumber",CreditNoteAmount:"CreditNoteAmount",PackageMapping:"PackageMapping"},outputs:{GetPaymentStatusEmit:"GetPaymentStatusEmit"},features:[i.Db],decls:4,vars:1,consts:[["class","table table-striped table-bordered",4,"ngIf"],["id","btnSubmit",1,"btn","btn-new-primary",3,"click"],[1,"table","table-striped","table-bordered"],[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(i.Sc(0,S,32,8,"table",0),i.Tb(1,"br"),i.Yb(2,"button",1),i.ic("click",function(){return t.initializePayment()}),i.Uc(3,"Pay"),i.Xb()),2&e&&i.tc("ngIf",(null==t.ItemPriceRes?null:t.ItemPriceRes.length)>0)},directives:[o.p,o.o],styles:[""]}),e})()},"Rtg/":function(e,t,s){"use strict";s.d(t,"a",function(){return U});var i=s("fXoL");let n=(()=>{class e{constructor(){}get nativeWindow(){return window}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Ob({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var r=s("G+wY"),o=s("NLkC"),l=s("ofXK");function c(e,t){1&e&&(i.Yb(0,"th"),i.Uc(1,"Discount Amount"),i.Xb())}function a(e,t){if(1&e&&(i.Yb(0,"td"),i.Uc(1),i.Xb()),2&e){const e=i.mc().$implicit;i.Fb(1),i.Vc(e.DiscountAmount)}}function d(e,t){if(1&e&&(i.Yb(0,"tr"),i.Yb(1,"td"),i.Uc(2),i.Xb(),i.Yb(3,"td"),i.Uc(4),i.Xb(),i.Yb(5,"td"),i.Uc(6),i.Xb(),i.Yb(7,"td"),i.Uc(8),i.Xb(),i.Sc(9,a,2,1,"td",3),i.Yb(10,"td"),i.Uc(11),i.Xb(),i.Xb()),2&e){const e=t.$implicit,s=i.mc(2);i.Fb(2),i.Vc(null==e.Description?null:e.Description.split("~")[0]),i.Fb(2),i.Vc(e.MRP),i.Fb(2),i.Vc(e.Qty),i.Fb(2),i.Vc(e.GST),i.Fb(1),i.tc("ngIf","Frontdesk"==s.PayRequestFrom),i.Fb(2),i.Vc(e.PriceWithGST)}}function b(e,t){1&e&&(i.Yb(0,"td"),i.Uc(1,"\xa0"),i.Xb())}function h(e,t){if(1&e&&(i.Yb(0,"tr"),i.Yb(1,"td"),i.Uc(2,"Total Amount"),i.Xb(),i.Yb(3,"td"),i.Uc(4,"\xa0"),i.Xb(),i.Yb(5,"td"),i.Uc(6,"\xa0"),i.Xb(),i.Yb(7,"td"),i.Uc(8,"\xa0"),i.Xb(),i.Sc(9,b,2,0,"td",3),i.Yb(10,"td"),i.Uc(11),i.Xb(),i.Xb()),2&e){const e=i.mc(2);i.Fb(9),i.tc("ngIf","Frontdesk"==e.PayRequestFrom),i.Fb(2),i.Vc(e.TotalPaybleAmount)}}function u(e,t){1&e&&(i.Yb(0,"td"),i.Uc(1,"\xa0"),i.Xb())}function m(e,t){if(1&e&&(i.Yb(0,"tr"),i.Yb(1,"td"),i.Uc(2,"Bill Wise Discount %"),i.Xb(),i.Yb(3,"td"),i.Uc(4),i.Xb(),i.Yb(5,"td"),i.Uc(6,"\xa0"),i.Xb(),i.Sc(7,u,2,0,"td",3),i.Yb(8,"td"),i.Uc(9,"Amount"),i.Xb(),i.Yb(10,"td"),i.Uc(11),i.Xb(),i.Xb()),2&e){const e=i.mc(2);i.Fb(4),i.Vc(e.BillWiseDiscountPer),i.Fb(3),i.tc("ngIf","Frontdesk"==e.PayRequestFrom),i.Fb(4),i.Vc(e.BillwiseDiscountAmount)}}function y(e,t){1&e&&(i.Yb(0,"td"),i.Uc(1,"\xa0"),i.Xb())}function R(e,t){if(1&e&&(i.Yb(0,"tr"),i.Yb(1,"td"),i.Uc(2,"Credit Note Balance Used"),i.Xb(),i.Yb(3,"td"),i.Uc(4),i.Xb(),i.Yb(5,"td"),i.Uc(6,"\xa0"),i.Xb(),i.Sc(7,y,2,0,"td",3),i.Yb(8,"td"),i.Uc(9,"\xa0"),i.Xb(),i.Yb(10,"td"),i.Uc(11,"\xa0"),i.Xb(),i.Xb()),2&e){const e=i.mc(2);i.Fb(4),i.Vc(e.CreditNoteAmount),i.Fb(3),i.tc("ngIf","Frontdesk"==e.PayRequestFrom)}}function P(e,t){1&e&&(i.Yb(0,"td"),i.Uc(1,"\xa0"),i.Xb())}function p(e,t){1&e&&(i.Yb(0,"td"),i.Uc(1,"\xa0"),i.Xb())}function S(e,t){if(1&e&&(i.Yb(0,"tr"),i.Yb(1,"td"),i.Uc(2,"Receive Amount"),i.Xb(),i.Yb(3,"td"),i.Uc(4),i.Xb(),i.Yb(5,"td"),i.Uc(6,"\xa0"),i.Xb(),i.Yb(7,"td"),i.Uc(8,"\xa0"),i.Xb(),i.Sc(9,p,2,0,"td",3),i.Yb(10,"td"),i.Uc(11,"\xa0"),i.Xb(),i.Xb()),2&e){const e=i.mc(2);i.Fb(4),i.Vc(e.ReceiveAmont),i.Fb(5),i.tc("ngIf","Frontdesk"==e.PayRequestFrom)}}function W(e,t){if(1&e&&(i.Yb(0,"table",2),i.Yb(1,"thead"),i.Yb(2,"tr"),i.Yb(3,"th"),i.Uc(4,"Item Details"),i.Xb(),i.Yb(5,"th"),i.Uc(6,"Rate"),i.Xb(),i.Yb(7,"th"),i.Uc(8,"Qty"),i.Xb(),i.Yb(9,"th"),i.Uc(10,"GST"),i.Xb(),i.Sc(11,c,2,0,"th",3),i.Yb(12,"th"),i.Uc(13,"Net Amount"),i.Xb(),i.Xb(),i.Xb(),i.Yb(14,"tbody"),i.Sc(15,d,12,6,"tr",4),i.Sc(16,h,12,2,"tr",3),i.Sc(17,m,12,3,"tr",3),i.Sc(18,R,12,2,"tr",3),i.Yb(19,"tr"),i.Yb(20,"td"),i.Uc(21,"Net Payable"),i.Xb(),i.Yb(22,"td"),i.Uc(23),i.Xb(),i.Yb(24,"td"),i.Uc(25,"\xa0"),i.Xb(),i.Yb(26,"td"),i.Uc(27,"\xa0"),i.Xb(),i.Sc(28,P,2,0,"td",3),i.Yb(29,"td"),i.Uc(30,"\xa0"),i.Xb(),i.Xb(),i.Sc(31,S,12,2,"tr",3),i.Xb(),i.Xb()),2&e){const e=i.mc();i.Fb(11),i.tc("ngIf","Frontdesk"==e.PayRequestFrom),i.Fb(4),i.tc("ngForOf",e.ItemPriceRes),i.Fb(1),i.tc("ngIf","Frontdesk"==e.PayRequestFrom),i.Fb(1),i.tc("ngIf","Frontdesk"==e.PayRequestFrom),i.Fb(1),i.tc("ngIf",e.CreditNoteAmount>0),i.Fb(5),i.Vc(e.NetPaybleAmount),i.Fb(5),i.tc("ngIf","Frontdesk"==e.PayRequestFrom),i.Fb(3),i.tc("ngIf",e.IsPartialPayment)}}let U=(()=>{class e{constructor(e,t,s,n){this.winRef=e,this.cdRef=t,this._PatientServices=s,this._UtilityService=n,this.ReceiveAmont=0,this.TotalPaybleAmount=0,this.BillwiseDiscountAmount=0,this.NetPaybleAmount=0,this.WellnessRazorPaymentResponse={},this.OrderRes={},this.IsSelectedItem=!1,this.UserRes={},this.BillWiseDiscountPer=0,this.ReferredBy="",this.RequestedBy="",this.PayRequestFrom="Frontdesk",this.ActualNetPayble=0,this.IsPartialPayment=!1,this.CreditNoteNumber=null,this.CreditNoteAmount=0,this.GetPaymentStatusEmit=new i.o,this.NewOrderRes={},this.WellnessPaymentResDTO={}}ngOnInit(){}ngOnChanges(e){this.NewOrderRes=JSON.parse(JSON.stringify(this.OrderRes)),this.ItemPriceRes.map(e=>{this.TotalPaybleAmount=this.TotalPaybleAmount+e.PriceWithGST}),this.BillWiseDiscountPer>0?(this.BillwiseDiscountAmount=this.TotalPaybleAmount*this.BillWiseDiscountPer/100,this.NetPaybleAmount=this.TotalPaybleAmount-this.BillwiseDiscountAmount,this.NetPaybleAmount=this.NetPaybleAmount-(this.CreditNoteAmount>0?this.CreditNoteAmount:0)):(this.BillwiseDiscountAmount=0,this.NetPaybleAmount=this.TotalPaybleAmount,this.NetPaybleAmount=this.NetPaybleAmount-(this.CreditNoteAmount>0?this.CreditNoteAmount:0)),null!=this.NewOrderRes&&null!=this.NewOrderRes&&(this.ReceiveAmont=Math.round(parseFloat(this.NewOrderRes.amount)/100),this.rzp1=new this.winRef.nativeWindow.Razorpay({key:this.NewOrderRes.APIKey,amount:this.NewOrderRes.amount,currency:"INR",name:"wellness",description:"Wellness Payment",image:"https://example.com/your_logo",order_id:this.NewOrderRes.id,handler:function(e){var t=new CustomEvent("payment.success",{detail:e,bubbles:!0,cancelable:!0});window.dispatchEvent(t)},prefill:{name:this.UserRes.FirstName+" "+this.UserRes.LastName,email:this.UserRes.Email,contact:this.UserRes.ContactNumber},notes:{address:"Patanjali Wellness Pre Payment"},theme:{color:"#3399cc"},modal:{ondismiss:function(){this.NewOrderRes={},console.log("Checkout form closed")}}}),this.rzp1.on("payment.failed",function(e){this._UtilityService.showErrorAlert(e.error.description)})),this.cdRef.detectChanges()}callrazor(){this.rzp1.open()}onPaymentSuccess(e){this.WellnessRazorPaymentResponse.id=e.detail.razorpay_payment_id,this.WellnessRazorPaymentResponse.status="created",this.WellnessRazorPaymentResponse.order_id=e.detail.razorpay_order_id,this.WellnessRazorPaymentResponse.international=!1,this.WellnessRazorPaymentResponse.amount_refunded=0,this.WellnessPaymentResDTO.ModifiedBy=localStorage.getItem("userId"),this.WellnessPaymentResDTO.CreditNoteNumber=this.CreditNoteNumber,this.WellnessPaymentResDTO.CreditNoteAmount=this.CreditNoteAmount,1==this.IsSelectedItem?(this.WellnessPaymentResDTO.WellnessRazorPaymentResponse=this.WellnessRazorPaymentResponse,this.WellnessPaymentResDTO.ItemPriceRes=this.ItemPriceRes,this.WellnessPaymentResDTO.BillWiseDiscountPer=this.BillWiseDiscountPer,this.WellnessPaymentResDTO.ReferredBy=this.ReferredBy,this.WellnessPaymentResDTO.RequestedBy=this.RequestedBy,this.WellnessPaymentResDTO.NetPayble=this.nullToZeroConverter(this.NewOrderRes.amount)/100,this.WellnessPaymentResDTO.PackageMapping=this.PackageMapping,this._UtilityService.showSpinner(),this._PatientServices.AddRazorPaymentResponseWellnessSelected(this.WellnessPaymentResDTO,this.SlotBookingIdSelected).subscribe(e=>{this._UtilityService.hideSpinner(),this.GetPaymentStatusEmit.emit("Success~"+e.actionResult.stringVal),this._UtilityService.showSuccessAlert(e.actionResult.errMsg)},e=>{this._UtilityService.hideSpinner(),this._UtilityService.showErrorAlert(e.message)})):(this.WellnessPaymentResDTO.WellnessRazorPaymentResponse=this.WellnessRazorPaymentResponse,this.WellnessPaymentResDTO.ItemPriceRes=this.ItemPriceRes,this.WellnessPaymentResDTO.BillWiseDiscountPer=this.BillWiseDiscountPer,this.WellnessPaymentResDTO.ReferredBy=this.ReferredBy,this.WellnessPaymentResDTO.RequestedBy=this.RequestedBy,this.WellnessPaymentResDTO.NetPayble=this.nullToZeroConverter(this.NewOrderRes.amount)/100,this.WellnessPaymentResDTO.ActualNetPayble=this.nullToZeroConverter(this.ActualNetPayble),this.WellnessPaymentResDTO.PackageMapping=this.PackageMapping,this._UtilityService.showSpinner(),this._PatientServices.AddRazorPaymentResponseWellness(this.WellnessPaymentResDTO,this.SlotBookingIdSelected).subscribe(e=>{this._UtilityService.hideSpinner(),this.GetPaymentStatusEmit.emit("Success~"),this._UtilityService.showSuccessAlert(e.actionResult.errMsg)},e=>{this._UtilityService.hideSpinner(),this._UtilityService.showErrorAlert(e.message)}))}nullToZeroConverter(e){return null==e||null==e||""==e||"Infinity"==e||"NaN"==e||isNaN(parseFloat(e))?0:parseFloat(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(n),i.Sb(i.h),i.Sb(r.a),i.Sb(o.a))},e.\u0275cmp=i.Mb({type:e,selectors:[["app-razorpay"]],hostBindings:function(e,t){1&e&&i.ic("payment.success",function(e){return t.onPaymentSuccess(e)},!1,i.Kc)},inputs:{OrderRes:"OrderRes",ItemPriceRes:"ItemPriceRes",SlotBookingIdSelected:"SlotBookingIdSelected",IsSelectedItem:"IsSelectedItem",UserRes:"UserRes",BillWiseDiscountPer:"BillWiseDiscountPer",ReferredBy:"ReferredBy",RequestedBy:"RequestedBy",PayRequestFrom:"PayRequestFrom",ActualNetPayble:"ActualNetPayble",IsPartialPayment:"IsPartialPayment",CreditNoteNumber:"CreditNoteNumber",CreditNoteAmount:"CreditNoteAmount",PackageMapping:"PackageMapping"},outputs:{GetPaymentStatusEmit:"GetPaymentStatusEmit"},features:[i.Eb([n]),i.Db],decls:4,vars:1,consts:[["class","table table-striped table-bordered",4,"ngIf"],["id","rzp-button1",1,"btn","btn-new-primary",3,"click"],[1,"table","table-striped","table-bordered"],[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(i.Sc(0,W,32,8,"table",0),i.Tb(1,"br"),i.Yb(2,"button",1),i.ic("click",function(){return t.callrazor()}),i.Uc(3,"Pay"),i.Xb()),2&e&&i.tc("ngIf",(null==t.ItemPriceRes?null:t.ItemPriceRes.length)>0)},directives:[l.p,l.o],styles:[""]}),e.\u0275prov=i.Ob({token:e,factory:e.\u0275fac}),e})()}}]);